/*!
 * Copyright (c) 2019 Oracle and/or its affiliates.
 *  All rights reserved. Oracle Chat Widget Web SDK, Release: 1.0.0
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.WebSDK=e():t.WebSDK=e()}(window,function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=16)}([function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n=function(t,e){var n=t[1]||"",i=t[3];if(!i)return n;if(e&&"function"==typeof btoa){var o=(r=i,a=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(c," */")),s=i.sources.map(function(t){return"/*# sourceURL=".concat(i.sourceRoot).concat(t," */")});return[n].concat(s).concat([o]).join("\n")}var r,a,c;return[n].join("\n")}(e,t);return e[2]?"@media ".concat(e[2],"{").concat(n,"}"):n}).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},o=0;o<this.length;o++){var s=this[o][0];null!=s&&(i[s]=!0)}for(var r=0;r<t.length;r++){var a=t[r];null!=a[0]&&i[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="(".concat(a[2],") and (").concat(n,")")),e.push(a))}},e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(12),o={LEFT:"left",RIGHT:"right"};e.MESSAGE_SIDE=o;var s=function(){function t(t,e,n,o,s,r){if(this.utils=t,this.settings=e,this.side=o,this.markAsRead=r,this.actions=[],this.globalActions=[],this._options={weekday:"long",year:"numeric",month:"long",day:"numeric"},this.date=s,n.actions)for(var a=0,c=0,l=n.actions;c<l.length;c++){a++,(d=l[c]).actionId="action"+a;var h=i.ActionComponentFactory.fromActionPayload(t,d);h&&(h.onActionClick=this.handleOnActionClick.bind(this),this.actions.push(h))}if(n.globalActions)for(var A=0,u=0,p=n.globalActions;u<p.length;u++){var d;A++,(d=p[u]).actionId="globalAction"+A;var g=i.ActionComponentFactory.fromActionPayload(t,d);g&&(g.onActionClick=this.handleOnActionClick.bind(this),this.globalActions.push(g))}}return t.prototype.handleOnActionClick=function(t){if(this.onActionClick){var e=t;e.messageComponent=this,this.onActionClick(e)}},t.prototype.handleOnActionTrigger=function(t){var e=+t.match(/\d+/g)[0];return"action"===t.match(/[a-zA-Z]+/g)[0]?this.actions.length>=e?this.actions[e-1]:null:this.globalActions.length>=e?this.globalActions[e-1]:null},t.prototype.render=function(t){return this._renderMessage(t,this.actions,this.globalActions)},t.prototype.updateMarkAsRead=function(){return this.renderMsgReadStatus(!0),this.markAsRead(this.date)},t.prototype.appendActions=function(t,e){if(e.length>0){for(var n=this.utils.createDiv(["message-actions"]),i=0,o=e;i<o.length;i++){var s=o[i];n.appendChild(s.render())}t.appendChild(n)}},t.prototype.appendGlobalActions=function(t,e){if(e.length>0){for(var n=this.utils.createDiv(["message-global-actions"]),i=0,o=e;i<o.length;i++){var s=o[i];n.appendChild(s.render())}t.appendChild(n)}},t.prototype.getContent=function(){throw new Error("Method not implemented.")},t.prototype.disableActions=function(t){if("postback"!==this.settings.disablePastActions||t){for(var e=0,n=this.actions;e<n.length;e++){(l=n[e]).disable()}for(var i=0,o=this.globalActions;i<o.length;i++){(l=o[i]).disable()}}else{for(var s=0,r=this.actions;s<r.length;s++){"postback"!==(l=r[s]).getActionType()&&"location"!==l.getActionType()||l.disable()}for(var a=0,c=this.globalActions;a<c.length;a++){var l;"postback"!==(l=c[a]).getActionType()&&"location"!==l.getActionType()||l.disable()}}},t.prototype.enableActions=function(){for(var t=0,e=this.actions;t<e.length;t++){e[t].enable()}for(var n=0,i=this.globalActions;n<i.length;n++){i[n].enable()}},t.prototype.renderMsgReadStatus=function(t){if(this._chatDate){var e=this.date?new Date(this.date):new Date,n=t?this.settings.readMark:"";this._chatDate.innerHTML=e.toLocaleTimeString(this.settings.locale,this._options)+n}},t.prototype._renderMessage=function(t,e,n){var i=this.utils.createDiv(["message",this.side]);i.style.color=this.settings.colors.text;var s=["message-wrapper"];n&&n.length>0&&s.push("has-global-actions"),this._messageWrapper=this.utils.createDiv(s),i.appendChild(this._messageWrapper);var r=this.side===o.LEFT?this.settings.botIcon:this.settings.personIcon;if(r){var a=this.utils.createDiv(["icon-wrapper"]);a.appendChild(this.utils.createImage(r,["message-icon"])),this._messageWrapper.appendChild(a)}var c=this.utils.createDiv(["message-bubble"]);c.style.padding=this.settings.messagePadding||c.style.padding;var l=this.utils.createDiv(["message-content"]);if(l.appendChild(t||this.getContent()),c.appendChild(l),e&&(this.settings.displayActionsAsPills?this.appendGlobalActions(i,e):this.appendActions(c,e)),this.settings.enableTimestamp){this._chatDate=this.utils.createDiv(["chat-message-date"]);var h=this.date?new Date(this.date):new Date;this._chatDate.innerHTML=h.toLocaleTimeString(this.settings.locale,this._options),c.appendChild(this._chatDate)}return this._messageWrapper.appendChild(c),n&&this.appendGlobalActions(i,n),i},t}();e.MessageComponent=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.module=t}return t.prototype.debug=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._log(t.LOG_LEVEL.DEBUG,e)},t.prototype.error=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._log(t.LOG_LEVEL.ERROR,e)},t.prototype.info=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._log(t.LOG_LEVEL.INFO,e)},t.prototype.warn=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._log(t.LOG_LEVEL.WARN,e)},t.prototype._log=function(e,n){if(t.logLevel>=e){n.unshift("["+t.appName+"."+t.appVersion+"."+this.module+"]");var i=void 0;switch(t.logLevel){case t.LOG_LEVEL.ERROR:i=console.error;break;case t.LOG_LEVEL.WARN:i=console.warn;break;case t.LOG_LEVEL.INFO:i=console.info;break;case t.LOG_LEVEL.DEBUG:i=console.debug}t.historyEnabled&&(t.history.push(Object.assign({},n,{level:e})),t._historySize<=t.history.length&&t.history.shift()),i.apply(console,n)}},t.LOG_LEVEL={DEBUG:4,ERROR:1,INFO:3,NONE:0,WARN:2},t.logLevel=t.LOG_LEVEL.ERROR,t.history=[],t.historyEnabled=!1,t._historySize=100,t}();e.Logger=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){this.utils=t,this._disabled=!1,this._actionId=e.actionId,this._type=e.type,this._label=e.label,this._imageUrl=e.imageUrl}return t.prototype.render=function(){if(this._htmlElement=this.utils.createAnchor(),this._htmlElement.onclick=this.handleOnClick.bind(this),this._label)this._htmlElement.innerText=this._label;else{var t=this.utils.createImage(this._imageUrl);this._htmlElement.appendChild(t)}return this._disabled&&this._htmlElement.classList.add(this.utils.getCssClassWithPrefix("disabled")),this._htmlElement},t.prototype.handleOnClick=function(t){if(this.onActionClick&&!this._disabled){var e={getPayload:this.getEventPayload.bind(this),label:this._label,type:this._type};this.onActionClick(e)}},t.prototype.disable=function(){this._disabled=!0,this._htmlElement&&this._htmlElement.classList.add(this.utils.getCssClassWithPrefix("disabled"))},t.prototype.enable=function(){this._disabled=!1,this._htmlElement&&this._htmlElement.classList.remove(this.utils.getCssClassWithPrefix("disabled"))},t.prototype.getActionType=function(){return this._type},t}();e.ActionComponent=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.utils=t}return t.prototype.addClass=function(t){this.element.classList.add(this.utils.getCssClassWithPrefix(t))},t.prototype.hide=function(t){void 0===t&&(t=!0),t?(this._orgDisplayStyle=this.element.style.display,this.element.style.display="none"):this.element.style.display=this._orgDisplayStyle},t.prototype.remove=function(){this.element.remove()},t.prototype.appendToElement=function(t){t.appendChild(this.element)},t.prototype.prependToElement=function(t){var e=t.firstChild;e?t.insertBefore(this.element,e):t.appendChild(this.element)},t.prototype.appendContentChildElement=function(t){this._getContentElement().appendChild(t)},t.prototype.appendContentChild=function(t){this._getContentElement().appendChild(t.element)},t.prototype._getContentElement=function(){return this.element},t}();e.Component=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.SVG_SPRITE={icon_bot_attach:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M23.1 9.9l-12.3 12-1-1L21.7 9a3.2 3.2 0 0 0-.4-4.5c-2.4-2.4-5 0-5 0l-13 13.1a1.9 1.9 0 0 0 .1 3c1.6 1.6 2.5.2 2.5.2L19 7.8a1.3 1.3 0 0 0 .2-1.3 1.2 1.2 0 0 0-1.2.3L7.5 17.5l-1.2-1 11-11.1s2.2-1 3.3 0-.1 3-.1 3L7.2 21.9s-2 2.8-5-.1a3.4 3.4 0 0 1-.4-4.9L16.1 2.6a5.7 5.7 0 0 1 6.6 1c2.7 2.8.4 6.3.4 6.3z"/></svg>',icon_bot_button:'<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 48 48"><path d="M0 24a24 24 0 1 0 48 0 24 24 0 1 0-48 0" fill="#1b8fd2" opacity=".8"/><path d="M32.25 31.084h-7.532L19.2 37.021a1.061 1.061 0 0 1-1.251-1.316l.031-4.622h-1.23C12.47 31.084 9 28.372 9 23.97A7.862 7.862 0 0 1 16.75 16h15.5A7.862 7.862 0 0 1 40 23.97c0 4.402-3.47 7.114-7.75 7.114zM16.531 20.938a2.594 2.594 0 1 0 2.594 2.594 2.594 2.594 0 0 0-2.594-2.594zm7.969-.031a2.594 2.594 0 1 0 2.594 2.593 2.594 2.594 0 0 0-2.594-2.594zm7.969.031a2.594 2.594 0 1 0 2.594 2.594 2.594 2.594 0 0 0-2.594-2.594z" fill="#fff" fill-rule="evenodd"/></svg>',icon_bot_clear:'<svg xmlns="http://www.w3.org/2000/svg" fill="#ffffff" width="16" height="16" viewBox="0 0 16 16"><path d="M1.777 7.11 h12.446v1.78H1.777zM0 10.668h12.445v1.777H0zm3.555-7.113H16v1.777H3.555zm0 0"/></svg>',icon_bot_collapse:'<svg xmlns="http://www.w3.org/2000/svg" fill="#ffffff" width="16" height="16" viewBox="0 0 16 16"><path d="M.031 13H16l-.031 2H0z"/></svg>',icon_bot_logo:'<svg xmlns="http://www.w3.org/2000/svg" fill="#FFFFFF" width="24" height="24" viewBox="0 0 24 24"><path class="svg-icon16" d="M18 16.99h-6.267L8 21.125a1.119 1.119 0 0 1-1.021-1.36V16.99H6a5.849 5.849 0 0 1-6-5.87A6.061 6.061 0 0 1 6 5h12a6.061 6.061 0 0 1 6 6.12 5.849 5.849 0 0 1-6 5.87zM6 9a2 2 0 1 0 2 2 2 2 0 0 0-2-2zm6 0a2 2 0 1 0 2 2 2 2 0 0 0-2-2zm6 0a2 2 0 1 0 2 2 2 2 0 0 0-2-2z"/></svg>',icon_bot_message_bubble:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 18"><path d="M18 12.99h-6.267L8 17.125a1.119 1.119 0 0 1-1.021-1.36V12.99H6a5.849 5.849 0 0 1-6-5.87A6.061 6.061 0 0 1 6 1h12a6.061 6.061 0 0 1 6 6.12 5.849 5.849 0 0 1-6 5.87z" fill="#d1d1d1"/><path d="M4 7a2 2 0 1 0 4 0 2 2 0 1 0-4 0" style="animation-name:dotScaleleft;animation-duration:1s;animation-iteration-count:infinite;transform-origin:20%;animation-delay:0s" fill="#fff"/><path d="M10 7a2 2 0 1 0 4 0 2 2 0 1 0-4 0" style="animation-name:dotScalecenter;animation-duration:1s;animation-iteration-count:infinite;transform-origin:43%;animation-delay:.2s" fill="#fff"/><path d="M16 7a2 2 0 1 0 4 0 2 2 0 1 0-4 0" style="animation-name:dotScaleright;animation-duration:1s;animation-iteration-count:infinite;transform-origin:70%;animation-delay:.4s" fill="#fff"/><style>@keyframes dotScaleleft{0%,to{transform:scale(1)}50%{transform:scale(1.25)}}@keyframes dotScalecenter{0%,to{transform:scale(1)}50%{transform:scale(1.25)}}@keyframes dotScaleright{0%,to{transform:scale(1)}50%{transform:scale(1.25)}}</style></svg>',icon_bot_next:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/><path d="M0 0h24v24H0z" fill="none"/></svg>',icon_bot_previous:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/><path d="M0 0h24v24H0z" fill="none"/></svg>',icon_bot_send:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M.992 1.4l22.631 11.128L.859 23.436l.422-8.822 12.431-2.077L1.517 10.1z"/></svg>',icon_bot_speech_mute:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path d="M8 16l-4.968-5.005H1.546A1.7 1.7 0 0 1-.019 9.109V6.751A1.572 1.572 0 0 1 1.515 4.98H3L8 0v16zm8.094-10.094L14 8.027l2.07 2.068-.926.988L13.037 9l-2.087 2.115-1.05-.989 2.114-2.137-2.076-2.051.969-1 2.074 2.072 2.081-2.1z"/></svg>',icon_bot_speech_unmute:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path d="M8 16l-4.968-5.005H1.546A1.7 1.7 0 0 1-.019 9.109V6.751A1.572 1.572 0 0 1 1.515 4.98H3L8 0v16zm3.28-1.045l-.736-1.206a6.173 6.173 0 0 0 0-11.6L11.28.941a7.562 7.562 0 0 1 0 14.014zm1.695-7.007A4.8 4.8 0 0 1 9.6 12.542l-.684-1.233a3.367 3.367 0 0 0 2.646-3.361 3.367 3.367 0 0 0-2.646-3.36L9.6 3.355a4.8 4.8 0 0 1 3.375 4.593z"/></svg>'}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(e,n){this.utils=n,this._title=t.capitalize(e.type)}return t.capitalize=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},t.prototype.createMessageElement=function(t,e){var n=this.utils.createDiv(["attachment-message"]),i=this.utils.createDiv(["attachment-icon"]);i.style.backgroundImage="url('"+t+"')";var o=this.utils.createDiv(["attachment-fileName"]),s=this.utils.createSpan(["attachment-file"]);return s.innerHTML=e,o.appendChild(s),n.appendChild(i),n.appendChild(o),n},t}();e.AttachmentComponent=i},function(t,e,n){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.POST_BACK="postback",t.CALL="call",t.URL="url",t.LOCATION="location"}(i||(i={})),e.ACTION_TYPE=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.GEOLOCATION_REQUEST_DENIED=1,t.CHAT_SCROLL_DELAY=300,t.WEBSOCKET_READY_STATE=["CONNECTING","OPEN","CLOSING","CLOSED"],t.WEBSOCKET_CLOSE_EVENT={CODE:{ABNORMAL_CLOSURE:1006}},t.FILE_SIZE_LIMIT_EXCEEDED=413,t.UNSUPPORTED_FILE_TYPE=415,t.FILE_SIZE_METADATA_HEADER="x-oda-meta-file-size",t.BIT_MULTIPLIER=1024,t.MAX_SUGGESTIONS_COUNT=5,t.MIN_SUGGESTIONS_COUNT=1,t}();e.Constants=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.utils={isDivVisible:function(t,e){var n=t.scrollTop,i=n+t.offsetHeight,o=e.offsetTop,s=o+e.offsetHeight;return o>n&&o<i||s<i&&s>n},isFunction:function(t){return"function"==typeof t},secToMillisec:function(t){return 1e3*t}}},function(t,e,n){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.TEXT="text",t.CARD="card",t.ATTACHMENT="attachment",t.LOCATION="location",t.RAW="raw",t.POSTBACK="postback",t.PROFILE="profile",t.ERROR="error",t.SUGGEST="suggest"}(i||(i={})),e.PAYLOAD_TYPE=i},function(t,e,n){"use strict";var i=this&&this.__rest||function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(t);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(t,i[o])&&(n[i[o]]=t[i[o]])}return n};Object.defineProperty(e,"__esModule",{value:!0});e.createBotMessage=function(t,e,n,i){return{date:n,from:t,isRead:i,messagePayload:e}};e.createUserMessage=function(t,e,n,o){var s=t.metadata,r={date:n,isRead:o,messagePayload:i(t,["metadata"]),userId:e};return s&&(r.metadata=s),r}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(7),o=n(18),s=n(19),r=n(20),a=n(13),c=n(2),l=function(){function t(){}return t.fromActionPayload=function(e,n){switch(n.type){case i.ACTION_TYPE.POST_BACK:return new r.PostbackActionComponent(e,n);case i.ACTION_TYPE.CALL:return new o.CallActionComponent(e,n);case i.ACTION_TYPE.LOCATION:return new s.LocationActionComponent(e,n);case i.ACTION_TYPE.URL:return new a.UrlActionComponent(e,n);default:return t.logger.error("Payload contains wrong action type:"+n.type),null}},t.logger=new c.Logger("ActionComponentFactory"),t}();e.ActionComponentFactory=l},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i._url=n.url,i}return o(e,t),e.prototype.render=function(){var e=t.prototype.render.call(this);return e.classList.add(this.utils.getCssClassWithPrefix("action-url")),e.target="_blank",e.href=this._url,e},e.prototype.getEventPayload=function(){return Promise.resolve(this._url)},e}(n(3).ActionComponent);e.UrlActionComponent=s},function(t,e,n){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.IMAGE="image",t.VIDEO="video",t.AUDIO="audio",t.FILE="file"}(i||(i={})),e.ATTACHMENT_TYPE=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(73);e.buildAuthTokenMessage=function(t,e){return{state:{token:e,tokenType:t,type:i.STATE_TYPE.AUTH}}};e.buildPingMessage=function(){return{state:{type:i.STATE_TYPE.PING}}};e.isPongMessage=function(t){return t.state&&t.state.type&&t.state.type===i.STATE_TYPE.PONG};e.PING_PONG_INTERVAL=3e4},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(17),o=n(2),s=n(40),r=n(41),a=n(69),c=function(){function t(t,e){this._events={},this._logger=new o.Logger("Main"),this._chatServerService=new a.ChatServerService(t,e),this._config=this._chatServerService.getChatConfiguration(),this._utils=new s.Utils(this._config),this._onLoad()}return t.prototype.triggerPostback=function(t){t?this._widgetComponent.triggerPostback(t,this._message):this._errorEmptyParameter("triggerPostback","triggerId")},t.prototype.connect=function(t){var e=this;t&&!this._config.clientAuthEnabled&&(this._chatServerService.setSettingsProperty("channelId",t.channelId),this._chatServerService.setSettingsProperty("userId",t.userId));var n=this._chatServerService.openConnection();return n.finally(function(){e._dispatchEvent("ready")}),n},t.prototype.disconnect=function(t,e){this._chatServerService.closeConnection(t,e)},t.prototype.openChat=function(){this._config.embedded?this._logger.error("Chat is in embedded mode, can not perform open action."):(this._widgetComponent.isOpen||this._widgetComponent.showChat(),this._dispatchEvent("widget:opened"))},t.prototype.closeChat=function(){this._config.embedded?this._logger.error("Chat is in embedded mode, can not perform close action."):(this._widgetComponent.isOpen&&this._widgetComponent.onClose(),this._dispatchEvent("widget:closed"))},t.prototype.destroy=function(){this._config.embedded?this._logger.error("Chat is in embedded mode, can not perform destroy action."):(this.closeChat(),this._widgetComponent.remove(),this._dispatchEvent("destroy"))},t.prototype.isChatOpened=function(){return this._widgetComponent.isOpen},t.prototype.sendMessage=function(t){t?this._widgetComponent.sendMessage(t):this._errorEmptyParameter("sendMessage","message")},t.prototype.getSuggestions=function(t){t?this._widgetComponent.getSuggestions(t):this._errorEmptyParameter("getSuggestions","query")},t.prototype.getUnreadMessagesCount=function(){var t=this._chatServerService.getUnreadMessagesCount();return t!==this._currentUnreadCount&&(this._currentUnreadCount=t,this._dispatchEvent("unreadCount",[t])),t},t.prototype.on=function(t,e){this._events.hasOwnProperty(t)?this._events[t].push(e):this._events[t]=[e]},t.prototype.off=function(t,e){if(t||e||(this._events={}),this._events.hasOwnProperty(t)){var n=this._events[t].indexOf(e);-1!==n&&this._events[t].splice(n,1)}},t.prototype.setChatBubbleIconHeight=function(t){if(t)for(var e=0,n=document.getElementsByClassName(this._utils.getCssClassWithPrefix("chat-bubble"));e<n.length;e++){n[e].style.height=t,this._config.height=t}else this._errorEmptyParameter("setChatBubbleIconHeight","height")},t.prototype.setChatBubbleIconSize=function(t,e){if(t||!e)for(var n=0,i=document.getElementsByClassName(this._utils.getCssClassWithPrefix("chat-bubble"));n<i.length;n++){var o=i[n];o.style.width=t,o.style.height=e,this._config.width=t,this._config.height=e}else this._errorEmptyParameter("setChatBubbleIconSize","width","height")},t.prototype.setChatBubbleIconWidth=function(t){if(t)for(var e=0,n=document.getElementsByClassName(this._utils.getCssClassWithPrefix("chat-bubble"));e<n.length;e++){n[e].style.width=t,this._config.width=t}else this._errorEmptyParameter("setChatBubbleIconWidth","width")},t.prototype.setDelegate=function(t){this._config.delegate=t},t.prototype.setFont=function(t){if(t){var e=document.getElementsByClassName(this._utils.getCssClassWithPrefix("wrapper"))[0];e&&(e.style.font=t,this._config.font=t)}else this._errorEmptyParameter("setFont","font")},t.prototype.setFontSize=function(t){if(t){var e=document.getElementsByClassName(this._utils.getCssClassWithPrefix("wrapper"))[0];e&&(e.style.fontSize=t)}else this._errorEmptyParameter("setFontSize","fontSize")},t.prototype.setHeight=function(t){if(t){var e=document.getElementsByClassName(this._utils.getCssClassWithPrefix("widget"))[0];e&&(e.style.height=t,this._config.height=t)}else this._errorEmptyParameter("setHeight","height")},t.prototype.setMessagePadding=function(t){if(t)for(var e=0,n=document.getElementsByClassName(this._utils.getCssClassWithPrefix("message-bubble"));e<n.length;e++){n[e].style.padding=t,this._config.messagePadding=t}else this._errorEmptyParameter("setMessagePadding","padding")},t.prototype.setSize=function(t,e){if(t||e){var n=document.getElementsByClassName(this._utils.getCssClassWithPrefix("widget"))[0];n&&(n.style.width=t,n.style.height=e,this._config.width=t,this._config.height=e)}else this._errorEmptyParameter("setSize","width","height")},t.prototype.setTextColor=function(t){if(t){var e=document.getElementsByClassName(this._utils.getCssClassWithPrefix("wrapper"))[0];e&&(e.style.color=t,this._config.colors.text=t)}else this._errorEmptyParameter("setTextColor","color")},t.prototype.setTextColorLight=function(t){if(t)for(var e=0,n=document.getElementsByClassName(this._utils.getCssClassWithPrefix("card-description"));e<n.length;e++){n[e].style.color=t,this._config.colors.textLight=t}else this._errorEmptyParameter("setTextColor","color")},t.prototype.setWidth=function(t){if(t){var e=document.getElementsByClassName(this._utils.getCssClassWithPrefix("widget"))[0];e&&(e.style.width=t,this._config.width=t)}else this._errorEmptyParameter("setWidth","width")},t.prototype.updateUser=function(t){t?this._chatServerService.updateUser(t):this._errorEmptyParameter("updateUser","userDetails")},t.prototype._errorEmptyParameter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];1===e.length?this._logger.error("Parameter "+e+" was not passed for "+t+" call. No action processed."):this._logger.error("Parameters "+e.join(", ")+" were not passed for "+t+" call. No action processed.")},t.prototype._sendMessage=function(t){this._dispatchEvent("message:sent",[t]),this._dispatchEvent("message",[t])},t.prototype._receiveMessage=function(t){t.from&&(this._dispatchEvent("message:received",[t]),this._dispatchEvent("message",[t])),this._message=t},t.prototype._onLoad=function(){if(this._logger.debug("onLoad","load chat widget"),!this._config.useCustomStyle){var t=new r.StyleComponent(this._utils,this._config);"undefined"!=typeof window&&document.head.appendChild(t.render())}this._createWidget(this._config.embedded)},t.prototype._createWidget=function(t){if(this._widgetComponent=new i.WidgetComponent(this._utils,this._config,this.openChat.bind(this),this.closeChat.bind(this),this._receiveMessage.bind(this),this._sendMessage.bind(this),this.getUnreadMessagesCount.bind(this),this._chatServerService),t)try{this._widgetComponent.embedInElement(this._config.targetElement)}catch(t){this._logger.error("Target Element not specified",t)}else this._widgetComponent.appendToElement(document.body)},t.prototype._dispatchEvent=function(t,e){if(this._events.hasOwnProperty(t)){e&&e.length||(e=[]);for(var n=this._events[t],i=n.length,o=0;o<i;o++)n[o].apply(null,e)}},t}();e.default=c},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n(11),r=n(1),a=n(8),c=n(9),l=n(7),h=n(10),A=n(21),u=n(22),p=n(23),d=n(4),g=n(24),f=n(2),m=n(35),_=n(36),b=n(38),v=n(39),y=function(t){function e(e,n,i,o,s,r,a,c){var l=t.call(this,e)||this;return l.settings=n,l.openChat=i,l.closeChat=o,l.receiveMessage=s,l.sentMessage=r,l.getUnreadMessagesCount=a,l.dataService=c,l._logger=new f.Logger("ChatComponent"),l._previousBotMessage=[],l._currentSessionBotMessages=[],l._consecutiveBotMessagesCount=0,l._attachmentDivs=[],l._unreadMessages=[],l.registerStatusCallback=function(t){l.dataService.onStatusChange=function(e){if(l._isFirstConnect&&l._loadPreviousConversations(),Number.isInteger(e)&&e!==WebSocket.OPEN){l._chatFooterComponent.isDisabled()||(l._chatFooterComponent.disable(),l._logger.debug("WebSocket not open, send message button disabled")),l._disableBotMessages(l._currentSessionBotMessages),l._removeChatBubble(),l._consecutiveBotMessagesCount&&l._currentSessionBotMessages.splice(0,l._currentSessionBotMessages.length-l._consecutiveBotMessagesCount);for(var n=0,i=l._attachmentDivs;n<i.length;n++){var o=i[n];l._handleUploadError(o.fileName,500,o.divId)}}else l._chatFooterComponent.isDisabled()&&(l._chatFooterComponent.disable(!1),l._logger.debug("WebSocket open, send message button enabled")),l._enableBotMessages();t(e)}},l.element=l._createElement(),l.isOpen=n.openChatOnLoad,l._isFirstConnect=!0,l._localeText=n.i18n[n.locale],l._narrationEnabled=n.enableBotAudioResponse,l._narrationEnabled&&l._initializeSpeechSynthesis(),l}return o(e,t),e.prototype.render=function(t){},e.prototype.embedInElement=function(t){var e=document.getElementById(t);if(!e)throw new Error("Can not embed chat widget.");this.chatWidgetDiv.style.width=e.clientWidth+"px",this.chatWidgetDiv.style.height=e.clientHeight+"px",this.chatWidgetDiv.style.position="inherit",this.chatWidgetDiv.style.boxShadow="none",this.appendToElement(e)},e.prototype.showChat=function(){this.isOpen||(this.element.classList.add(this.utils.getCssClassWithPrefix("open")),this.isOpen=!0,this._updateUnreadMessages())},e.prototype.onClose=function(){if(this.isOpen){this.element.classList.remove(this.utils.getCssClassWithPrefix("open"));var t=this.getUnreadMessagesCount();t>0?this._botButton.appendChild(this._botNotificationBadge):this._botNotificationBadge&&this._botNotificationBadge.remove(),this._botNotificationBadge.innerText=""+t,this._speechSynthesis&&this._speechSynthesis.cancel(),this.isOpen=!1}},e.prototype.onToggleNarration=function(t){this._toggleNarration(t)},e.prototype.remove=function(){t.prototype.remove.call(this),this.dataService.onMessage=function(){}},e.prototype.clearMessage=function(){localStorage.setItem(this.settings.name+"-"+this.settings.userId+"-messages",JSON.stringify([])),this._conversationContainer.innerHTML="",this._renderMessages([],!1),this._narrationEnabled&&this._speechSynthesis&&this.isOpen&&(this._speechSynthesis.pause(),this._speechSynthesis.cancel())},e.prototype.triggerPostback=function(t,e){var n,i=this,o=t.match(/[a-zA-Z]+/g)[0],r=+t.match(/\d+/g)[0];if("card"===o){var a=g.MessageComponentFactory.fromMessage(this.utils,this.settings,e,this._markAsRead.bind(this));n=a.cards.length>=r?a.cards[r-1].handleOnActionTrigger(t):null}else{a=g.MessageComponentFactory.fromMessage(this.utils,this.settings,e,this._markAsRead.bind(this));n=a.handleOnActionTrigger(t)}n&&n.getEventPayload().then(function(t){var e=s.createUserMessage({postback:t,text:n.label,type:h.PAYLOAD_TYPE.POSTBACK},i.settings.userId,new Date,!0);i._sendMessageToServer(e)})},e.prototype.onMessageActionClicked=function(t){var n=this;if(t.type===l.ACTION_TYPE.POST_BACK)this._scrollToBottom(),"none"!==this.settings.disablePastActions&&t.messageComponent.disableActions(),t.getPayload().then(function(e){var i=s.createUserMessage({postback:e,text:t.label,type:h.PAYLOAD_TYPE.POSTBACK},n.settings.userId,new Date,!0);t.label===n._localeText.retryMessage?n.dataService.retryMessage(i):n._sendMessageToServer(i)});else if(t.type===l.ACTION_TYPE.LOCATION){var i=document.getElementById(e.MESSAGES_ID),o=new _.LoadingMessageComponent(this._localeText.requestLocation,r.MESSAGE_SIDE.LEFT,this.utils);i.appendChild(o.render()),this._scrollToBottom(),"none"!==this.settings.disablePastActions&&t.messageComponent.disableActions(),t.getPayload().then(function(e){o.remove();var i=s.createUserMessage({location:{latitude:e.latitude,longitude:e.longitude,title:"@Share Location"===t.label?"@demo location":void 0},type:h.PAYLOAD_TYPE.LOCATION},n.settings.userId,new Date,!0);n._sendMessageToServer(i)}).catch(function(t){if(t.code===a.Constants.GEOLOCATION_REQUEST_DENIED){var e=new b.MessageStringComponent(n._localeText.requestLocationString,r.MESSAGE_SIDE.LEFT,n.utils);o.remove(),i.appendChild(e.render(n.settings.errorIcon))}})}},e.prototype.sendMessage=function(t){var e;if(t)if("string"==typeof t?e={text:t,type:h.PAYLOAD_TYPE.TEXT}:t.type!==h.PAYLOAD_TYPE.TEXT&&t.type!==h.PAYLOAD_TYPE.LOCATION||(e=t),e){var n=s.createUserMessage(e,this.settings.userId,new Date,!0);this._sendMessageToServer(n)}else this._logger.error("Can not parse payload from message",t);else this._logger.error("No message passed to send to bot")},e.prototype.uploadFile=function(t){this._scrollToBottom();var n=new Date,i=t.name.replace(/[\s:\'"\\\/\[\]~,\.;^`()@#%\*+=$&!{}?<>|]/g,"")+1e4*(Math.random()+Date.parse(n.toDateString())+n.getTime())%1e8,o=this.utils.createDiv();if(o.id=i,this._attachmentDivs.push({divId:i,fileName:t.name}),document.getElementById(e.MESSAGES_ID).appendChild(o),t.size>this.settings.maxAttachmentFileSize*a.Constants.BIT_MULTIPLIER*a.Constants.BIT_MULTIPLIER)this._scrollToBottom(),this._handleUploadError(t.name,a.Constants.FILE_SIZE_LIMIT_EXCEEDED,i);else{var s=new _.LoadingMessageComponent(t.name,r.MESSAGE_SIDE.RIGHT,this.utils);o.appendChild(s.render()),this._scrollToBottom(),this.dataService.uploadAttachment(t,this._handleUploadError.bind(this),i,!0)}},e.prototype.getSuggestions=function(t){var e=this.settings.numberOfSuggestions>a.Constants.MAX_SUGGESTIONS_COUNT?a.Constants.MAX_SUGGESTIONS_COUNT:this.settings.numberOfSuggestions<a.Constants.MIN_SUGGESTIONS_COUNT?a.Constants.MIN_SUGGESTIONS_COUNT:this.settings.numberOfSuggestions,n=s.createUserMessage({query:t,threshold:e,type:h.PAYLOAD_TYPE.SUGGEST},this.settings.userId,new Date,!0);this.dataService.getSuggestions(n)},e.prototype._handleUploadError=function(t,e,n){var i;switch(e){case a.Constants.FILE_SIZE_LIMIT_EXCEEDED:i=t+" - "+this._localeText.uploadErrors.fileSizeLimitExceeded;break;case a.Constants.UNSUPPORTED_FILE_TYPE:i=t+" - "+this._localeText.uploadErrors.unsupportedFileType;break;default:i=t+" - "+this._localeText.uploadErrors.uploadFailed}var o=new b.MessageStringComponent(i,r.MESSAGE_SIDE.LEFT,this.utils),s=document.getElementById(n);s.firstElementChild&&s.removeChild(s.firstElementChild),this._attachmentDivs=this._attachmentDivs.filter(function(t){return t.divId!==n}),s.appendChild(o.render(this.settings.errorIcon))},e.prototype._createElement=function(){var t=this.settings.locale,n=this.utils.createDiv(this.settings.embedded?[]:["wrapper"]);n.style.font=this.settings.font,n.style.color=this.settings.colors.text,this.chatWidgetDiv=this.utils.createDiv(["widget"]),this.chatWidgetDiv.style.width=this.settings.width||this.chatWidgetDiv.style.width,this.chatWidgetDiv.style.height=this.settings.height||this.chatWidgetDiv.style.height;var i=new u.WidgetHeaderComponent(this.utils,this.settings,this.closeChat.bind(this),this.clearMessage.bind(this),this.onToggleNarration.bind(this),this.registerStatusCallback.bind(this));if(this.chatWidgetDiv.appendChild(i.element),this.settings.embedTopStickyId)try{var o=this.utils.createDiv(["embed-sticky-top"]);o.appendChild(document.getElementById(this.settings.embedTopStickyId)),this.chatWidgetDiv.appendChild(o)}catch(t){this._logger.error("No element present with id "+this.settings.embedTopStickyId+". Can not embed pinned content.")}if(this._conversationComponent=new p.WidgetMainComponent(this.utils,this.settings),this._conversationComponent.element.id=e.CHAT_MESSAGES_PARENT_ID,this._conversationComponent.element.addEventListener("scroll",this._updateUnreadMessages.bind(this)),this._scrollContent=this.utils.createDiv(["conversation-pane"]),this.settings.embedTopScrollId)try{var s=this.utils.createDiv(["embed-scroll-top"]);s.appendChild(document.getElementById(this.settings.embedTopScrollId)),this._scrollContent.appendChild(s)}catch(t){this._logger.error("No element present with id "+this.settings.embedTopScrollId+". Can not embed scrollable content.")}var r=this.utils.createDiv("bottom"===this.settings.conversationBeginPosition?["empty-conversation-div"]:void 0);if(this._scrollContent.appendChild(r),this._conversationContainer=this.utils.createDiv(["conversation-container"]),this._conversationContainer.id=e.MESSAGES_ID,this._scrollContent.appendChild(this._conversationContainer),this._conversationComponent.element.appendChild(this._scrollContent),this.settings.embedBottomScrollId)try{var a=this.utils.createDiv(["embed-scroll-bottom"]);a.appendChild(document.getElementById(this.settings.embedBottomScrollId)),this._conversationComponent.element.appendChild(a)}catch(t){this._logger.error("No element present with id "+this.settings.embedBottomScrollId+". Can not embed scrollable content.")}if(this.chatWidgetDiv.appendChild(this._conversationComponent.element),this.settings.embedBottomStickyId)try{var c=this.utils.createDiv(["embed-sticky-bottom"]);c.appendChild(document.getElementById(this.settings.embedBottomStickyId)),this.chatWidgetDiv.appendChild(c)}catch(t){this._logger.error("No element present with id "+this.settings.embedBottomStickyId+". Can not embed pinned content.")}if(this._chatFooterComponent=new A.ChatFooterComponent(this.utils,this.sendMessage.bind(this),this.uploadFile.bind(this),this.settings,this.getSuggestions.bind(this)),this.chatWidgetDiv.appendChild(this._chatFooterComponent.element),n.appendChild(this.chatWidgetDiv),this.settings.embedded)this.isOpen=!0,n.classList.add(this.utils.getCssClassWithPrefix("open"));else{this._botButton=this.utils.createButton(["button"]),this._botButton.title=this.settings.i18n[t].chatTitle,this._botButton.style.backgroundColor=this.settings.colors.branding;var l=this.utils.createImage(this.settings.botButtonIcon,["button-icon"]);this._botButton.appendChild(l),this._botButton.onclick=this.openChat.bind(this),this._botNotificationBadge=this.utils.createDiv(["notification-badge"]),this.settings.badgePosition&&(this.settings.badgePosition.bottom&&(this._botNotificationBadge.style.bottom=this.settings.badgePosition.bottom),this.settings.badgePosition.left&&(this._botNotificationBadge.style.left=this.settings.badgePosition.left),this.settings.badgePosition.right&&(this._botNotificationBadge.style.right=this.settings.badgePosition.right),this.settings.badgePosition.top&&(this._botNotificationBadge.style.top=this.settings.badgePosition.top));var h=this.getUnreadMessagesCount();this._botNotificationBadge.innerText=""+h,h>0&&this._botButton.appendChild(this._botNotificationBadge),n.appendChild(this._botButton),this.settings.position.bottom&&(n.style.bottom=this.settings.position.bottom),this.settings.position.left&&(n.style.left=this.settings.position.left),this.settings.position.top&&(n.style.top=this.settings.position.top),this.settings.position.right&&(n.style.right=this.settings.position.right),this.settings.openChatOnLoad&&n.classList.add(this.utils.getCssClassWithPrefix("open"))}return n},e.prototype._scrollToBottom=function(){var t=document.getElementById(e.CHAT_MESSAGES_PARENT_ID);setTimeout(function(){t&&(t.scrollTop=t.scrollHeight)},a.Constants.CHAT_SCROLL_DELAY)},e.prototype._renderMessages=function(t,e,n){for(var i=this,o=0,s=t.length,r=0,a=t;r<a.length;r++){var c=a[r];o++;var l=g.MessageComponentFactory.fromMessage(this.utils,this.settings,c,this._markAsRead.bind(this),this._isURLReachable.bind(this),e);if(e||("none"!==this.settings.disablePastActions&&(c.from?this._previousBotMessage.push(l):(this._disableBotMessages(this._previousBotMessage),this._previousBotMessage=[])),c.from?(this._currentSessionBotMessages.push(l),this._consecutiveBotMessagesCount++):this._consecutiveBotMessagesCount=0),n){var h=document.getElementById(n);h.removeChild(h.firstElementChild),h.appendChild(l.render()),this._attachmentDivs=this._attachmentDivs.filter(function(t){return t.divId!==n})}else{var A=l.render();this._conversationContainer.appendChild(A);var u={component:l,element:A};this._markMessageAsReadIfVisible(u),this._unreadMessages.push(u)}l.onActionClick=this.onMessageActionClicked.bind(this),e&&o<=s&&l.disableActions(e)}this.settings.embedded||this.isOpen||e||setTimeout(function(){var t=i.getUnreadMessagesCount();t>0&&(i._botNotificationBadge.innerText=""+t,i._botButton.appendChild(i._botNotificationBadge))})},e.prototype._disableBotMessages=function(t){for(var e=0,n=t;e<n.length;e++){n[e].disableActions()}},e.prototype._enableBotMessages=function(){for(var t=0,e=this._currentSessionBotMessages;t<e.length;t++){e[t].enableActions()}},e.prototype._markAsRead=function(t){this.dataService.markAsRead(t)},e.prototype._onMessageReceived=function(t,e){this._logger.debug("onMessageReceived",t),this._removeChatBubble(),this._renderMessages([t],!1,e),this.receiveMessage(t),this._scrollToBottom(),t.from&&this._utterMessage(t)},e.prototype._initializeSpeechSynthesis=function(){this._speechSynthesis=window.speechSynthesis;var t=this._speechSynthesis.getVoices().filter(function(t){return t.default})[0];this._speechUtterance=new SpeechSynthesisUtterance,this._speechUtterance.voice=t},e.prototype._utterMessage=function(t){this._narrationEnabled&&this._speechSynthesis&&this.isOpen&&(this._speechSynthesis.cancel(),this._speechUtterance.text=g.MessageComponentFactory.extractUtteranceText(t),this._speechSynthesis.speak(this._speechUtterance))},e.prototype._toggleNarration=function(t){this._narrationEnabled=t,t?this._speechSynthesis.resume():(this._speechSynthesis.pause(),this._speechSynthesis.cancel())},e.prototype._onSuggestionsReceived=function(t){null!=t&&t.suggestions&&t.suggestions.length>0&&null!=this._chatFooterComponent&&this._chatFooterComponent.displaySuggestions(t.suggestions)},e.prototype._removeChatBubble=function(){this._chatBubbleDiv&&this._chatBubbleDiv.remove()},e.prototype._sendMessageToServer=function(t){this._scrollToBottom(),this.dataService.send(t),this.sentMessage(t),this.settings.showTypingIndicator&&(this._chatBubbleDiv=new m.ChatBubbleComponent(r.MESSAGE_SIDE.LEFT,this.utils,this.settings),this._conversationContainer.appendChild(this._chatBubbleDiv.render()),this._scrollToBottom())},e.prototype._updateUnreadMessages=function(){var t=this;if(this.isOpen){var e=[];this._unreadMessages.forEach(function(n){t._markMessageAsReadIfVisible(n)||e.push(n)}),this._unreadMessages=e}},e.prototype._markMessageAsReadIfVisible=function(t){var e=!1;return this.isOpen&&c.utils.isDivVisible(this._conversationComponent.element,t.element)&&(t.component.updateMarkAsRead(),e=!0),e},e.prototype._loadPreviousConversations=function(){if(this._isFirstConnect=!1,this.settings.enableLocalConversationHistory){var t=this.dataService.loadChat();t.length>0&&(this._renderMessages(t.slice(),!0),this._conversationContainer.appendChild(new v.StatusComponent(this.settings.i18n[this.settings.locale].previousChats,this.utils).render()),this._conversationContainer.appendChild(document.createElement("hr")),this._scrollToBottom())}this.dataService.onMessage=this._onMessageReceived.bind(this),this.dataService.onSuggestions=this._onSuggestionsReceived.bind(this)},e.prototype._isURLReachable=function(t){return this.dataService.isURLReachable(t)},e.MESSAGES_ID="ochat_widget_messages",e.CHAT_MESSAGES_PARENT_ID="chat_widget_main",e}(d.Component);e.WidgetComponent=y},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i._phoneNumber=n.phoneNumber,i}return o(e,t),e.prototype.render=function(){var e=t.prototype.render.call(this);return e.classList.add(this.utils.getCssClassWithPrefix("action-call")),e.href="tel:"+this._phoneNumber,e},e.prototype.getEventPayload=function(){return Promise.resolve(this._phoneNumber)},e}(n(3).ActionComponent);e.CallActionComponent=s},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(e,n){return t.call(this,e,n)||this}return o(e,t),e.prototype.render=function(){var e=t.prototype.render.call(this);return e.classList.add(this.utils.getCssClassWithPrefix("action-location")),e},e.prototype.getEventPayload=function(){return this.getCurrentPosition()},e.prototype.getCurrentPosition=function(){return new Promise(function(t,e){setTimeout(function(){navigator.geolocation.getCurrentPosition(function(e){t({latitude:e.coords.latitude,longitude:e.coords.longitude})},function(t){e(t)})})})},e}(n(3).ActionComponent);e.LocationActionComponent=s},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i._postback=n.postback,i}return o(e,t),e.prototype.render=function(){var e=t.prototype.render.call(this);return e.classList.add(this.utils.getCssClassWithPrefix("action-postback")),e},e.prototype.getEventPayload=function(){return Promise.resolve(this._postback)},e}(n(3).ActionComponent);e.PostbackActionComponent=s},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s,r=n(4),a=n(5);!function(t){t.ENTER="Enter",t.ARROW_DOWN="ArrowDown",t.ARROW_UP="ArrowUp"}(s||(s={}));var c=function(t){function e(e,n,i,o,s){var r=t.call(this,e)||this;return r.onSend=n,r.onUpload=i,r.settings=o,r.onQueryChange=s,r.element=r._createElement(),r}return o(e,t),e.prototype.onClick=function(){this._textArea.value&&""!==this._textArea.value.trim()&&(this._textArea.value=this._textArea.value.trim().replace("\n",""),this._onSend())},e.prototype.triggerUploadDocument=function(t){this._uploadFileInput.click()},e.prototype.uploadDocument=function(t){t.target.files&&t.target.files.length>0&&this._onUpload(t.target.files[0])},e.prototype.render=function(t){},e.prototype.disable=function(t){void 0===t&&(t=!0),this._sendButton.disabled=t,this.settings.enableAttachment&&(this._uploadButton.disabled=t),t?this._textArea.classList.add(this.utils.getCssClassWithPrefix("disabled")):this._textArea.classList.remove(this.utils.getCssClassWithPrefix("disabled"))},e.prototype.isDisabled=function(){return this._sendButton.disabled},e.prototype.displaySuggestions=function(t){var n=this;if(this._removeSuggestionsDiv(),this._textArea.value){this._currentSuggestionFocus=t.length;var i=this.utils.createDiv(["autocomplete-items"]);i.id=e.SUGGESTIONS_ID;for(var o=function(t){var e=s.utils.createDiv([]);e.innerHTML=t,e.onclick=function(){n._textArea.value=e.innerText,n._removeSuggestionsDiv(),n._sendButton.click()},i.appendChild(e)},s=this,r=0,a=t;r<a.length;r++){o(a[r])}this.element.appendChild(i)}},e.prototype._createElement=function(){var t=this.settings.locale,e=this.utils.createDiv(["footer"]);if(this.settings.enableAttachment){if(this._uploadButton=this.utils.createButton(["footer-button","button-upload"]),this._uploadButton.title=this.settings.i18n[t].upload,this.settings.uploadIcon){var n=this.utils.createImage(this.settings.uploadIcon,["footer-button-icon"]);this._uploadButton.appendChild(n)}else{n=this.utils.createElementFromString(a.SVG_SPRITE.icon_bot_attach);var i=this.utils.getCssClassWithPrefix("footer-button-svg-icon");n.classList.add(i),this._addHoverStyle(i),this._uploadButton.appendChild(n)}this._uploadButton.onclick=this.triggerUploadDocument.bind(this),e.appendChild(this._uploadButton),this._uploadFileInput=this.utils.createInput([],"file"),this._uploadFileInput.onchange=this.uploadDocument.bind(this),this._uploadFileInput.accept=this.settings.supportedFileTypes}if(this._textArea=this.utils.createTextArea(["user-input"]),this._textArea.onkeyup=this.onInputKeyUp.bind(this),this.settings.enableAutocomplete&&(this._textArea.onkeydown=this.onInputKeyDown.bind(this)),this._textArea.oninput=this._expand.bind(this),this._textArea.placeholder=this.settings.i18n[t].inputPlaceholder,this._textArea.autofocus=!0,this._textArea.style.font=this.settings.font,this._textArea.rows=1,e.appendChild(this._textArea),this._sendButton=this.utils.createButton(["footer-button","button-send"]),this._sendButton.title=this.settings.i18n[t].send,this.settings.sendIcon)this._sendButtonIcon=this.utils.createImage(this.settings.sendIcon,["footer-button-icon"]),this._sendButton.appendChild(this._sendButtonIcon);else{var o=this.utils.createElementFromString(a.SVG_SPRITE.icon_bot_send),s=this.utils.getCssClassWithPrefix("footer-button-svg-icon");o.classList.add(s),this._addHoverStyle(s),this._sendButton.appendChild(o)}return this._sendButton.onclick=this.onClick.bind(this),e.appendChild(this._sendButton),this.disable(!0),e},e.prototype._addHoverStyle=function(t){var e="."+t+":hover {fill: "+this.settings.colors.branding+";}";this.utils.addStyleToHTML(this.utils.createStyle(e))},e.prototype.onInputKeyUp=function(t){if(this.settings.enableAutocomplete&&!Object.values(s).includes(t.key))this._textArea.value&&""!==this._textArea.value.trim()&&this._textArea.value.length>=3?this._previousInputValue!==this._textArea.value&&(this._previousInputValue=this._textArea.value,this._suggestionsRequestTimer=this.settings.delaySuggestionsFetch,clearTimeout(this._suggestionsRequest),this._setSuggestionsRequestTimer()):(this._previousInputValue=void 0,this._removeSuggestionsDiv(),clearTimeout(this._suggestionsRequest));else if(t.key===s.ENTER&&this._textArea.value&&""!==this._textArea.value.trim()){if(t.preventDefault(),this._previousInputValue=void 0,this.isDisabled())return;this.settings.enableAutocomplete&&this._removeSuggestionsDiv(),this._textArea.value=this._textArea.value.trim().replace("\n",""),this._onSend()}},e.prototype.onInputKeyDown=function(t){var n=document.getElementById(e.SUGGESTIONS_ID);if(n){var i=n.getElementsByTagName("div");t.key===s.ARROW_DOWN?(t.preventDefault(),this._currentSuggestionFocus<i.length-1?(this._currentSuggestionFocus++,this._addActive(i)):(this._removeActive(i),this._textArea.value=this._currentInputValue?this._currentInputValue:this._textArea.value,this._currentSuggestionFocus=i.length)):t.key===s.ARROW_UP&&(t.preventDefault(),this._currentSuggestionFocus===i.length&&(this._currentInputValue=this._textArea.value),this._currentSuggestionFocus>0&&this._currentSuggestionFocus--,this._addActive(i))}},e.prototype._addActive=function(t){if(!t)return!1;this._removeActive(t),t[this._currentSuggestionFocus].classList.add(this.utils.getCssClassWithPrefix("autocomplete-active")),this._textArea.value=t[this._currentSuggestionFocus].innerText},e.prototype._removeActive=function(t){for(var e=0,n=t;e<n.length;e++){n[e].classList.remove(this.utils.getCssClassWithPrefix("autocomplete-active"))}},e.prototype._removeSuggestionsDiv=function(){var t=document.getElementById(e.SUGGESTIONS_ID);t&&t.remove()},e.prototype._onSend=function(){this._textArea.value.trim().replace("\n",""),this.onSend(this._textArea.value),this._textArea.value="",this._textArea.innerText="",setTimeout(this._expand.bind(this))},e.prototype._onUpload=function(t){this.onUpload(t),this._uploadFileInput.value=""},e.prototype._onQueryChange=function(){this.onQueryChange(this._textArea.value.trim())},e.prototype._setSuggestionsRequestTimer=function(){var t=this;this._suggestionsRequest=setTimeout(function(){t._onQueryChange()},this._suggestionsRequestTimer)},e.prototype._expand=function(){this._textArea.style.height=null;var t=this._textArea.scrollHeight;this._textArea.style.height=t+"px"},e.SUGGESTIONS_ID="chat_widget_suggestions",e}(r.Component);e.ChatFooterComponent=c},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n(4),r=n(5),a=function(t){function e(e,n,i,o,s,r){var a=t.call(this,e)||this;return a.settings=n,a.onClose=i,a.onClearMessage=o,a.onAudioToggle=s,a.element=a._createElement(),r(a._updateStatusMessage.bind(a)),a}return o(e,t),e.prototype.render=function(t){},e.prototype.closeWidgetPopup=function(){this.onClose()},e.prototype.clearHistory=function(){this.onClearMessage()},e.prototype._createElement=function(){var t=this,e=this.settings.locale,n=this.utils.createDiv(["header"]);if(n.style.background=this.settings.colors.branding,this.settings.logoIcon){var i=this.utils.createImage(this.settings.logoIcon,["logo"]);n.appendChild(i)}var o=this.settings.i18n[e].chatTitle||(this.settings.i18n["en-us"]?this.settings.i18n["en-us"].chatTitle:void 0);if(o){var s=this.utils.createDiv(["title"]);if(s.innerText=this.settings.i18n[e].chatTitle,s.title=o,this.settings.showConnectionStatus){var a=this.utils.createDiv(["header-info-wrapper"]);this._connectionStatus=this.utils.createDiv(["connection-status","disconnected"]),this._connectionStatus.innerText=this.settings.i18n[e].connecting,a.appendChild(s),a.appendChild(this._connectionStatus),n.appendChild(a)}else n.appendChild(s)}if(this.settings.customHeaderElementId){var c=document.getElementById(this.settings.customHeaderElementId);n.appendChild(c)}if(this.settings.enableClearMessage){var l=this.utils.createButton(["header-button","button-clear"]);if(l.style.backgroundColor=this.settings.colors.branding,l.title=this.settings.i18n[e].clear,this.settings.clearButtonIcon){var h=this.utils.createImage(this.settings.clearButtonIcon);l.appendChild(h)}else{var A=this.utils.createElementFromString(r.SVG_SPRITE.icon_bot_clear,["header-button-icon"]);l.appendChild(A)}l.onclick=this.clearHistory.bind(this),n.appendChild(l)}if(this.settings.enableBotAudioResponse&&window.speechSynthesis){this._audioButtonOn=!0;var u,p,d=this.utils.createButton(["header-button","button-narration"]);d.style.backgroundColor=this.settings.colors.branding,d.title=this.settings.i18n[e].audioResponseOn,this.settings.botAudioIconOn?(u=this.utils.createImage(this.settings.botAudioIconOn),d.appendChild(u)):(p=this.utils.createElementFromString(r.SVG_SPRITE.icon_bot_speech_unmute,["header-button-icon"]),d.appendChild(p)),d.onclick=function(){t._audioButtonOn=!t._audioButtonOn,t._audioButtonOn?(t.settings.botAudioIconOn?u.src=t.settings.botAudioIconOn:(d.innerHTML="",p=t.utils.createElementFromString(r.SVG_SPRITE.icon_bot_speech_unmute,["header-button-icon"]),d.appendChild(p)),d.title=t.settings.i18n[e].audioResponseOn):(t.settings.botAudioIconOff?u.src=t.settings.botAudioIconOff:(d.innerHTML="",p=t.utils.createElementFromString(r.SVG_SPRITE.icon_bot_speech_mute,["header-button-icon"]),d.appendChild(p)),d.title=t.settings.i18n[e].audioResponseOff),t.onAudioToggle(t._audioButtonOn)},n.appendChild(d)}if(!this.settings.embedded){var g=this.utils.createButton(["header-button","button-close"]);if(g.style.backgroundColor=this.settings.colors.branding,g.title=this.settings.i18n[e].close,this.settings.closeIcon){var f=this.utils.createImage(this.settings.closeIcon);g.appendChild(f)}else{var m=this.utils.createElementFromString(r.SVG_SPRITE.icon_bot_collapse,["header-button-icon"]);g.appendChild(m)}g.onclick=this.closeWidgetPopup.bind(this),n.appendChild(g)}return n},e.prototype._updateStatusMessage=function(t){if(this.settings.showConnectionStatus)switch(this._connectionStatus.className=this.utils.getCssClassWithPrefix("connection-status"),t){case WebSocket.OPEN:this._connectionStatus.innerText=this.settings.i18n[this.settings.locale].connected,this._connectionStatus.classList.remove(this.utils.getCssClassWithPrefix("connecting"),this.utils.getCssClassWithPrefix("disconnected")),this._connectionStatus.classList.add(this.utils.getCssClassWithPrefix("connected"));break;case WebSocket.CLOSED:this._connectionStatus.innerText=this.settings.i18n[this.settings.locale].disconnected,this._connectionStatus.classList.remove(this.utils.getCssClassWithPrefix("connecting"),this.utils.getCssClassWithPrefix("connected")),this._connectionStatus.classList.add(this.utils.getCssClassWithPrefix("disconnected"));break;case WebSocket.CLOSING:this._connectionStatus.innerText=this.settings.i18n[this.settings.locale].closing,this._connectionStatus.classList.remove(this.utils.getCssClassWithPrefix("connected"),this.utils.getCssClassWithPrefix("disconnected")),this._connectionStatus.classList.add(this.utils.getCssClassWithPrefix("connecting"));break;case WebSocket.CONNECTING:this._connectionStatus.innerText=this.settings.i18n[this.settings.locale].connecting,this._connectionStatus.classList.remove(this.utils.getCssClassWithPrefix("connected"),this.utils.getCssClassWithPrefix("disconnected")),this._connectionStatus.classList.add(this.utils.getCssClassWithPrefix("connecting"))}},e}(s.Component);e.WidgetHeaderComponent=a},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(e,n){var i=t.call(this,e)||this;return i.settings=n,i.element=i._createElement(),i}return o(e,t),e.prototype.render=function(t){},e.prototype._createElement=function(){return this.utils.createDiv(["conversation"])},e}(n(4).Component);e.WidgetMainComponent=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(10),o=n(25),s=n(30),r=n(32),a=n(1),c=n(33),l=n(34),h=function(){function t(){}return t.fromMessage=function(t,e,n,h,A,u){var p,d;switch(n.from?(p=a.MESSAGE_SIDE.LEFT,d=n.messagePayload):(p=a.MESSAGE_SIDE.RIGHT,d=n.messagePayload),d.type){case i.PAYLOAD_TYPE.TEXT:return new l.TextMessageComponent(t,e,d,p,n.date,h);case i.PAYLOAD_TYPE.ATTACHMENT:return new o.AttachmentMessageComponent(t,e,d,p,n.date,h,A,u);case i.PAYLOAD_TYPE.CARD:return new s.CardMessageComponent(t,e,d,p,n.date,h);case i.PAYLOAD_TYPE.LOCATION:return new r.LocationMessageComponent(t,e,d,p,n.date,h);case i.PAYLOAD_TYPE.RAW:return new c.RawMessageComponent(t,e,d,p,n.date,h);default:throw Error("Wrong message payload type:"+d.type)}},t.extractUtteranceText=function(t){var e=(t.from,t.messagePayload);switch(e.type){case i.PAYLOAD_TYPE.ATTACHMENT:return this._extractUtteranceAttachment(e);case i.PAYLOAD_TYPE.CARD:return this._extractUtteranceCard(e);case i.PAYLOAD_TYPE.RAW:return this._extractUtteranceRaw(e);case i.PAYLOAD_TYPE.TEXT:return this._extractUtteranceText(e);default:return"Bot response."}},t._extractUtteranceAttachment=function(t){return t.attachment.type+" attachment."},t._extractUtteranceCard=function(t){var e=this,n="";return t.cards.forEach(function(t,i){n=n.concat("Card "+(i+1)+": ").concat(t.title+":").concat(t.description?t.description+".":"."),t.actions&&(n=n.concat(e._extractActionsText(t.actions)))}),t.actions&&(n=n.concat(this._extractActionsText(t.actions))),t.globalActions&&(n=n.concat(this._extractActionsText(t.globalActions))),n},t._extractUtteranceRaw=function(t){var e=t.payload;return t.actions&&(e=e.concat(this._extractActionsText(t.actions))),t.globalActions&&(e=e.concat(this._extractActionsText(t.globalActions))),e},t._extractUtteranceText=function(t){var e=t.text;return t.actions&&(e=e.concat(this._extractActionsText(t.actions))),t.globalActions&&(e=e.concat(this._extractActionsText(t.globalActions))),e},t._extractActionsText=function(t){var e=" ";return t.forEach(function(t){e=e.concat(t.label?t.label+",":",")}),e},t}();e.MessageComponentFactory=h},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n(14),r=n(26),a=n(27),c=n(28),l=n(29),h=n(1),A=function(t){function e(n,i,o,r,a,c,l,A){var u=t.call(this,n,i,o,r,a,c)||this;u._date=a;var p=!1;return h.MESSAGE_SIDE.RIGHT!==r||s.ATTACHMENT_TYPE.FILE===o.attachment.type||A||(p=l(o.attachment.url)),u._attachment=e.fromPayload(n,i,o.attachment,r,p),u}return o(e,t),e.fromPayload=function(t,e,n,i,o){switch(n.type){case s.ATTACHMENT_TYPE.IMAGE:return new c.ImageAttachmentComponent(t,e,n,i,o);case s.ATTACHMENT_TYPE.VIDEO:return new l.VideoAttachmentComponent(t,e,n,i,o);case s.ATTACHMENT_TYPE.AUDIO:return new r.AudioAttachmentComponent(t,e,n,i,o);case s.ATTACHMENT_TYPE.FILE:return new a.FileAttachmentComponent(t,e,n,i);default:throw Error("Payload contains wrong attachment type")}},e.prototype.render=function(e){var n=this.utils.createDiv();return n.appendChild(t.prototype.render.call(this)),n},e.prototype.getContent=function(){return this._attachment.render()},e}(h.MessageComponent);e.AttachmentMessageComponent=A},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n(1),r=function(t){function e(e,n,i,o,s){var r=t.call(this,i,e)||this;return r.settings=n,r.payload=i,r.side=o,r.isReachable=s,r._url=i.url,r}return o(e,t),e.prototype.render=function(){if(s.MESSAGE_SIDE.RIGHT!==this.side||this.isReachable){var t=this.utils.createAudio(this._url,"attachment-audio",this.settings.autoplayAudio);return t.controls=!0,s.MESSAGE_SIDE.RIGHT===this.side&&t.setAttribute("controlsList","nodownload"),t.innerHTML='Your browser does not support embedded audio. However you can<a href="'+this._url+'">download it</a>.',t}return this.createMessageElement(this.settings.audioIcon,this.payload.fileName)},e}(n(6).AttachmentComponent);e.AudioAttachmentComponent=r},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n(1),r=function(t){function e(e,n,i,o){var s=t.call(this,i,e)||this;return s.settings=n,s.payload=i,s.side=o,s._url=i.url,s}return o(e,t),e.prototype.render=function(){return s.MESSAGE_SIDE.RIGHT===this.side?this.createMessageElement(this.settings.fileIcon,this.payload.fileName):this.utils.createAnchor(this._url,this.payload.fileName,["attachment-file"])},e}(n(6).AttachmentComponent);e.FileAttachmentComponent=r},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n(1),r=function(t){function e(e,n,i,o,s){var r=t.call(this,i,e)||this;return r.settings=n,r.payload=i,r.side=o,r.isReachable=s,r._url=i.url,r}return o(e,t),e.prototype.render=function(){return s.MESSAGE_SIDE.RIGHT!==this.side||this.isReachable?this.utils.createImage(this._url,["attachment-image"],this.payload.fileName):this.createMessageElement(this.settings.imageIcon,this.payload.fileName)},e}(n(6).AttachmentComponent);e.ImageAttachmentComponent=r},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n(1),r=function(t){function e(e,n,i,o,s){var r=t.call(this,i,e)||this;return r.settings=n,r.payload=i,r.side=o,r.isReachable=s,r._url=i.url,r}return o(e,t),e.prototype.render=function(){if(s.MESSAGE_SIDE.RIGHT!==this.side||this.isReachable){if(this._url.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/)){var t=this.utils.createSpan();return t.innerHTML=this.utils.linkify(this._url,{embeddedHTML:!0,embeddedVideo:this.settings.embeddedVideo}),t}(e=this.utils.createVideo(this._url,"attachment-video",this.settings.autoplayVideo)).controls=!0;e.attributes;return s.MESSAGE_SIDE.RIGHT===this.side&&e.setAttribute("controlsList","nodownload"),e.innerHTML='Your browser does not support embedded video. However you can <a href="'+this._url+'">download it</a>.',e}var e;return e=this.createMessageElement(this.settings.videoIcon,this.payload.fileName)},e}(n(6).AttachmentComponent);e.VideoAttachmentComponent=r},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n(1),r=n(31),a=n(5),c=function(t){function e(e,n,i,o,s,a){var c=t.call(this,e,n,i,o,s,a)||this;c.cards=[],c._layout=i.layout,c.date=s;for(var l=0,h=0,A=i.cards;h<A.length;h++){var u=A[h];l++,c.cards.push(new r.CardComponent(c.utils,c.settings,u,l))}return c}return o(e,t),e.prototype.render=function(){var t=this.utils.createDiv(["message","card-message-"+this._layout,this.side]);this._currentCard=0;var e=this.utils.createDiv(["message-wrapper"]),n=this.utils.createDiv(["card-message-content"]);if(this._cardsmsg=this.utils.createDiv(["card-message-cards"]),"horizontal"!==this._layout)for(var i=0,o=this.cards;i<o.length;i++){var s;(s=o[i]).onActionClick=this.handleOnActionClick.bind(this),this._cardsmsg.appendChild(s.render())}else(s=this.cards[this._currentCard]).onActionClick=this.handleOnActionClick.bind(this),this._cardsmsg.appendChild(s.render());return"horizontal"===this._layout&&this.cards.length>1&&this._cardsmsg.appendChild(this._getNextButton()),n.appendChild(this._cardsmsg),e.appendChild(n),t.appendChild(e),this.appendGlobalActions(t,this.actions),this.appendGlobalActions(t,this.globalActions),t},e.prototype.disableActions=function(e){t.prototype.disableActions.call(this,e);for(var n=0,i=this.cards;n<i.length;n++){i[n].disableActions(e)}},e.prototype.enableActions=function(){t.prototype.enableActions.call(this);for(var e=0,n=this.cards;e<n.length;e++){n[e].enableActions()}},e.prototype.nextCard=function(){this._currentCard++,this._cardsmsg.innerHTML="";var t=this.cards[this._currentCard];t.onActionClick=this.handleOnActionClick.bind(this),this._cardsmsg.appendChild(this._getPreviousButton()),this._currentCard<this.cards.length-1&&this._cardsmsg.appendChild(this._getNextButton()),this._cardsmsg.appendChild(t.render())},e.prototype.previousCard=function(){this._currentCard--,this._cardsmsg.innerHTML="",0!==this._currentCard&&this._cardsmsg.appendChild(this._getPreviousButton());var t=this.cards[this._currentCard];t.onActionClick=this.handleOnActionClick.bind(this),this._currentCard<this.cards.length-1&&this._cardsmsg.appendChild(this._getNextButton()),this._cardsmsg.appendChild(t.render())},e.prototype._getNextButton=function(){if(!this._buttonNext){this._buttonNext=this.utils.createDiv(["round","next"]);var t=this.utils.createElementFromString(a.SVG_SPRITE.icon_bot_next);this._buttonNext.appendChild(t),this._buttonNext.onclick=this.nextCard.bind(this)}return this._buttonNext},e.prototype._getPreviousButton=function(){if(!this._buttonPrevious){this._buttonPrevious=this.utils.createDiv(["round","previous"]);var t=this.utils.createElementFromString(a.SVG_SPRITE.icon_bot_previous);this._buttonPrevious.appendChild(t),this._buttonPrevious.onclick=this.previousCard.bind(this)}return this._buttonPrevious},e}(s.MessageComponent);e.CardMessageComponent=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(12),o=function(){function t(t,e,n,o){if(this.utils=t,this.settings=e,this._actions=[],this._title=n.title,this._description=n.description,this._imageUrl=n.imageUrl,this._url=n.url,n.actions)for(var s=0,r=0,a=n.actions;r<a.length;r++){var c=a[r];s++,c.actionId="card"+o+"Action"+s;var l=i.ActionComponentFactory.fromActionPayload(t,c);l&&(l.onActionClick=this.handleOnActionClick.bind(this),this._actions.push(l))}}return t.prototype.handleOnActionClick=function(t){this.onActionClick&&this.onActionClick(t)},t.prototype.handleOnActionTrigger=function(t){var e=+t.match(/\d+/g)[1];return this._actions[e-1]},t.prototype.render=function(){var t=this._url?this.utils.createAnchor(this._url,"",["card"]):this.utils.createDiv(["card"]),e=this.settings.locale;this._url&&(t.innerText=""),this._imageUrl&&t.appendChild(this.utils.createImage(this._imageUrl,[],this.settings.i18n[e].cardImagePlaceholder));var n=this.utils.createDiv(["card-content"]),i=this.utils.createDiv(["card-title"]);if(i.innerText=this._title,n.appendChild(i),this._description){var o=this.utils.createDiv(["card-description"]);o.style.color=this.settings.colors.textLight,o.innerText=this._description,n.appendChild(o)}if(t.appendChild(n),this._actions.length>0){for(var s=this.utils.createDiv(this.settings.displayActionsAsPills?["card-actions","card-actions-pill"]:["card-actions"]),r=0,a=this._actions;r<a.length;r++){var c=a[r];s.appendChild(c.render())}t.appendChild(s)}return t},t.prototype.disableActions=function(t){if("postback"!==this.settings.disablePastActions||t)for(var e=0,n=this._actions;e<n.length;e++){(s=n[e]).disable()}else for(var i=0,o=this._actions;i<o.length;i++){var s;"postback"!==(s=o[i]).getActionType()&&"location"!==s.getActionType()||s.disable()}},t.prototype.enableActions=function(){for(var t=0,e=this._actions;t<e.length;t++){e[t].enable()}},t}();e.CardComponent=o},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n(7),r=n(13),a=function(t){function e(e,n,i,o,s,r){var a=t.call(this,e,n,i,o,s,r)||this;return a._title=i.location.title,a._url=i.location.url,a._longitude=i.location.longitude,a._latitude=i.location.latitude,a._date=s,a}return o(e,t),e.prototype.render=function(){if(0===this.actions.length){var e={actionId:"locationAction1",label:"Open Map",type:s.ACTION_TYPE.URL,url:this._url||"http://www.google.com/maps?z=12&t=m&q=loc:"+this._latitude+"+"+this._longitude};this.actions.push(new r.UrlActionComponent(this.utils,e))}return t.prototype.render.call(this)},e.prototype.getContent=function(){var t=this.utils.createSpan();return this._title?t.innerText=this._title:t.innerText=this._latitude.toFixed(6)+", "+this._longitude.toFixed(6),t},e}(n(1).MessageComponent);e.LocationMessageComponent=a},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(e,n,i,o,s,r){var a=t.call(this,e,n,i,o,s,r)||this;return a._date=s,a._payload=JSON.stringify(i.payload),a}return o(e,t),e.prototype.getContent=function(){var t=this.utils.createSpan();return t.innerText=this._payload,t},e}(n(1).MessageComponent);e.RawMessageComponent=s},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n(1),r=function(t){function e(e,n,i,o,s,r){var a=t.call(this,e,n,i,o,s,r)||this;return a._text=i.text,a._date=s,a}return o(e,t),e.prototype.getContent=function(){var t=this.utils.createSpan();return t.innerHTML=this.utils.linkify(this._text,{embeddedHTML:this.side===s.MESSAGE_SIDE.LEFT,embeddedVideo:!0}),t},e}(s.MessageComponent);e.TextMessageComponent=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(5),o=function(){function t(t,e,n){this.side=t,this.utils=e,this.settings=n}return t.prototype.render=function(){var t;return this._element=this.utils.createDiv(["message",this.side]),(t=this.settings.chatBubbleIcon?this.utils.createImage(this.settings.chatBubbleIcon):this.utils.createElementFromString(i.SVG_SPRITE.icon_bot_message_bubble)).style.height=this.settings.chatBubbleIconHeight||t.style.height,t.style.width=this.settings.chatBubbleIconWidth||t.style.width,this._element.appendChild(t),this._element},t.prototype.remove=function(){this._element.remove()},t}();e.ChatBubbleComponent=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(37),o=function(){function t(t,e,n){this.text=t,this.side=e,this.utils=n}return t.prototype.render=function(){this._element=this.utils.createDiv(["loading-message",this.side]);var t=this.utils.createDiv(["message-bubble"]),e=this.utils.createDiv(["message-content","loading-icon"]);e.appendChild(new i.SpinnerComponent(this.utils).render());var n=this.utils.createDiv(["message-text"]),o=this.utils.createSpan();return o.innerHTML=this.text,n.appendChild(o),e.appendChild(n),t.appendChild(e),this._element.appendChild(t),this._element},t.prototype.remove=function(){this._element.remove()},t}();e.LoadingMessageComponent=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.utils=t}return t.prototype.render=function(){var t=this.utils.createDiv(["spinner"]);return t.innerHTML='<svg viewBox="0 0 64 64"><circle transform="translate(32,32)" r="26"></circle></svg>',t},t}();e.SpinnerComponent=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e,n){this.text=t,this.side=e,this.utils=n}return t.prototype.render=function(t){this._element=this.utils.createDiv(["message",this.side]);var e=this.utils.createDiv(["message-bubble"]),n=this.utils.createDiv(["message-content"]);t&&n.classList.add(this.utils.getCssClassWithPrefix("message-with-icon"));var i=this.utils.createDiv(["error-icon"]);i.appendChild(this.utils.createImage(t));var o=this.utils.createDiv(["message-text"]),s=this.utils.createSpan();return s.innerHTML=this.text,o.appendChild(s),n.appendChild(i),n.appendChild(o),e.appendChild(n),this._element.appendChild(e),this._element},t}();e.MessageStringComponent=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e,n){this.message=t,this.utils=e,this.image=n,this._element=e.createDiv(["status-message-container"]);var i=e.createDiv(["status-message-wrapper"]);if(n){var o=e.createImage(n,["status-image"]);i.appendChild(o)}var s=e.createDiv(["status-message"]);s.textContent=t,i.appendChild(s),this._element.appendChild(i)}return t.prototype.remove=function(){this._element.remove()},t.prototype.render=function(){return this._element},t}();e.StatusComponent=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.settings=t}return t.prototype.clone=function(t){return JSON.parse(JSON.stringify(t))},t.prototype.linkify=function(t,e){var n,i,o=this;return(e=e||{}).embeddedHTML||(t=(t=t.replace(/</g,"&lt;")).replace(/>/g,"&gt;")),n=/^(?!href=['"])(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,i=/(^|[^\/])(www\.[\S][-A-Z0-9+&@#\/%=.~_|]+(\b|$))/gim,t.replace(n,function(t,n,i){var s=e.embeddedVideo?o.getYouTubeVideoId(n):null;return s?'<iframe width="100%" src="https://www.youtube.com/embed/'+s+'" frameborder="0" allowfullscreen></iframe>':'<a href="'+n+'" target="_blank">'+n+"</a>"}).replace(i,function(t,n,i){var s=e.embeddedVideo?o.getYouTubeVideoId("https://"+i):null;return s?'<iframe width="100%" src="https://www.youtube.com/embed/'+s+'" frameborder="0" allowfullscreen></iframe>':n+'<a href="https://'+i+'" target="_blank">'+i+"</a>"})},t.prototype.getYouTubeVideoId=function(t){var e=t.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/);return e&&11===e[2].length?e[2]:null},t.prototype.getCssClassWithPrefix=function(t){return this.settings.name+"-"+t},t.prototype.createButton=function(t){var e=document.createElement("button");if(t)for(var n=0,i=t;n<i.length;n++){var o=i[n];e.classList.add(this.getCssClassWithPrefix(o))}return e},t.prototype.createAnchor=function(t,e,n){var i=document.createElement("a");if(t&&(i.href=t,i.target="_blank"),e?i.innerText=e:t&&(i.innerText=t),n)for(var o=0,s=n;o<s.length;o++){var r=s[o];i.classList.add(this.getCssClassWithPrefix(r))}return i},t.prototype.createDiv=function(t){var e=document.createElement("div");if(t)for(var n=0,i=t;n<i.length;n++){var o=i[n];e.classList.add(this.getCssClassWithPrefix(o))}return e},t.prototype.createElementFromString=function(t,e){var n=document.createElement("template");return t=t.trim(),n.innerHTML=t,e&&e.forEach(function(t){return n.content.firstElementChild.classList.add(t)}),n.content.firstElementChild},t.prototype.createParagraph=function(t){var e=document.createElement("p");if(t)for(var n=0,i=t;n<i.length;n++){var o=i[n];e.classList.add(this.getCssClassWithPrefix(o))}return e},t.prototype.createSpan=function(t){var e=document.createElement("span");if(t)for(var n=0,i=t;n<i.length;n++){var o=i[n];e.classList.add(this.getCssClassWithPrefix(o))}return e},t.prototype.createInput=function(t,e){var n=document.createElement("input");if(t)for(var i=0,o=t;i<o.length;i++){var s=o[i];n.classList.add(this.getCssClassWithPrefix(s))}return e&&(n.type=e),n},t.prototype.createTextArea=function(t){var e=document.createElement("TEXTAREA");if(t)for(var n=0,i=t;n<i.length;n++){var o=i[n];e.classList.add(this.getCssClassWithPrefix(o))}return e},t.prototype.createImage=function(t,e,n){var i=document.createElement("img");if(t&&(i.src=t),e)for(var o=0,s=e;o<s.length;o++){var r=s[o];i.classList.add(this.getCssClassWithPrefix(r))}return n&&(i.alt=n),i},t.prototype.createAudio=function(t,e,n){var i=document.createElement("audio");return t&&(i.src=t),i.autoplay=void 0!==n&&n,e&&i.classList.add(this.getCssClassWithPrefix(e)),i},t.prototype.createVideo=function(t,e,n){var i=document.createElement("video");return t&&(i.src=t),i.autoplay=void 0!==n&&n,e&&i.classList.add(this.getCssClassWithPrefix(e)),i},t.prototype.createWrappedSvg=function(t,e){var n=this.createDiv(e);return n.appendChild(t),n},t.prototype.createHTML=function(t){var e=this.createDiv();return e.innerHTML=t,e},t.prototype.createStyle=function(t){var e=document.createElement("style");return e.type="text/css",e.appendChild(document.createTextNode(t)),e},t.prototype.addStyleToHTML=function(t){window&&document.head.appendChild(t)},t}();e.Utils=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(42),o=function(){function t(t,e){this.utils=t,this.settings=e}return t.prototype.render=function(){return this.utils.createStyle(t.STYLE.replace(/(\.)([a-zA-Z_-]+)/gi,"$1"+this.settings.name+"-$2"))},t.STYLE=i.css,t}();e.StyleComponent=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(43),o=n(45),s=n(47),r=n(49),a=n(51),c=n(53),l=n(55),h=n(57),A=n(59),u=""+i+r+o+s+a+c+l+h+n(61)+A+n(63)+n(65)+n(67);e.css=u},function(t,e,n){var i=n(44);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(t.exports=n(0)(!1)).push([t.i,".conversation-container {\n    padding: 10px 10px 0 10px;\n}\n\n.wrapper {\n    bottom: 20px;\n    box-sizing: border-box;\n    height: 0;\n    position: fixed;\n    right: 20px;\n    width: 0;\n    z-index: 10000;\n}\n\n.button {\n    background-position: center center;\n    background-repeat: no-repeat;\n    border: none;\n    border-radius: 50%;\n    bottom: 0;\n    box-shadow: 0 -1px 5px 0 rgba(0, 0, 0, 0.35);\n    cursor: pointer;\n    display: block;\n    height: 48px;\n    overflow: visible;\n    padding: 0;\n    position: absolute;\n    right: 0;\n    text-align: center;\n    visibility: visible;\n    width: 48px;\n    z-index: 10000;\n}\n\n.open .button {\n    visibility: hidden;\n}\n\n.button img {\n    max-height: 100%;\n    max-width: 100%;\n}\n\n.widget {\n    background: #ffffff;\n    box-shadow: -4px 2px 21px 0 rgba(112, 112, 112, 0.50);\n    bottom: 0;\n    display: flex;\n    flex-direction: column;\n    height: 70vh;\n    margin: 0;\n    max-height: calc(100vh - 20px);\n    max-width: 768px;\n    min-width: 300px;\n    position: absolute;\n    right: 0;\n    visibility: hidden;\n    width: 30vw;\n    z-index: 10000;\n}\n\n.open .widget {\n    visibility: visible;\n}\n\n.conversation-pane {\n    display: flex;\n    flex: 1 1 auto;\n    flex-direction: column;\n}\n\n.empty-conversation-div {\n    display: flex;\n    flex: auto;\n}\n\n.chat-message-date {\n    font-size: 10px;\n    padding: 6px 0;\n}\n\n.notification-badge {\n    align-items: center;\n    background: rgb(230, 8, 27);\n    background-size: 10px;\n    border-radius: 45%;\n    color: #fff;\n    display: flex;\n    height: 24px;\n    justify-content: center;\n    position: absolute;\n    text-align: center;\n    width: 32px;\n}\n\n.embed-sticky-top {\n    padding-top: 5px;\n    padding-bottom: 5px;\n}\n\n.embed-scroll-top {\n    padding-top: 5px;\n    padding-bottom: 10px;\n}\n\n.embed-scroll-bottom {\n    padding-top: 10px;\n    padding-bottom: 5px;\n}\n\n.embed-sticky-bottom {\n    padding-top: 5px;\n    padding-bottom: 5px;\n}\n\n@media (max-width: 767px) {\n    .wrapper {\n        right: 10px !important;\n        bottom: 20px !important;\n    }\n\n    .widget {\n        margin-top: 20px;\n        max-width: calc(100vw - 10px);\n        max-height: calc(100vh - 40px);\n    }\n\n    .button-icon {\n        max-height: 48px;\n        max-width: 48px;\n    }\n}\n\n@media (min-width: 768px) {\n    .button {\n        height: 64px;\n        width: 64px;\n    }\n\n    .button-icon {\n        max-height: 64px;\n        max-width: 64px;\n    }\n}\n",""])},function(t,e,n){var i=n(46);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(t.exports=n(0)(!1)).push([t.i,".footer {\n    align-items: center;\n    background-color: #ffffff;\n    border-top: 1px solid #dadada;\n    box-sizing: border-box;\n    display: flex;\n    flex-direction: row;\n    max-height: 78px;\n    padding: 12px 10px 12px 2px;\n    position: relative;\n}\n\n.footer-button {\n    align-items: center;\n    background-color: transparent;\n    border: none;\n    cursor: pointer;\n    display: inline-block;\n    -webkit-tap-highlight-color: transparent;\n    justify-content: center;\n    max-height: 24px;\n    max-width: 24px;\n    overflow: hidden;\n    padding: 0;\n    text-shadow: none;\n}\n\n.footer-button-icon {\n    background-size: 100%;\n    background-position: center;\n    height: 100%;\n    margin: auto;\n    padding: 0;\n    width: 100%;\n}\n\n.footer-button-svg-icon {\n    height: 24px;\n    fill: #878C90;\n    width: 24px;\n}\n\n.footer-button:disabled .footer-button-svg-icon,\n.footer-button:disabled .footer-button-svg-icon:active,\n.footer-button:disabled .footer-button-svg-icon:hover {\n    fill: #cbcccd;\n}\n\n.button-upload {\n    height: 24px;\n    width: 24px;\n    margin-left: 8px;\n}\n\n.button-send {\n    height: 24px;\n    width: 24px;\n}\n\n.user-input {\n    border: none;\n    color: #333333;\n    flex: 1;\n    height: 100%;\n    margin-left: 8px;\n    margin-right: 8px;\n    max-height: 100%;\n    outline: none;\n    padding: 2px;\n    resize: none;\n}\n\n.user-input::placeholder {\n    padding: 5px 2;\n    color: #707070;\n}\n\n.user-input.disabled {\n    color: #737373;\n}\n\n.user-input.disabled::placeholder {\n    color: #cbcccd;\n}\n\n.autocomplete-items {\n    border-top: 1px solid #dadada;\n    border-bottom: 1px solid #dadada;\n    bottom: 100%;\n    left: 0;\n    position: absolute;\n    right: 0;\n    z-index: 11000;\n}\n\n.autocomplete-items div {\n    background-color: #fff;\n    cursor: pointer;\n    padding: 10px;\n}\n\n.autocomplete-items div:hover {\n    background-color: #e9e9e9;\n}\n\n.autocomplete-active {\n    background-color: #85bbe7 !important;\n}\n",""])},function(t,e,n){var i=n(48);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(t.exports=n(0)(!1)).push([t.i,".header {\n    align-items: center;\n    box-sizing: border-box;\n    color: #ffffff;\n    display: flex;\n    flex-direction: row;\n    height: 48px;\n    justify-content: space-between;\n    padding-left: 10px;\n    padding-right: 8px;\n}\n\n.logo {\n    flex: 0;\n    height: 24px;\n    max-height: 32px;\n    max-width: 32px;\n    min-height: 16px;\n    width: 24px;\n}\n\n.header-info-wrapper {\n    align-items: flex-start;\n    display: flex;\n    flex: 1;\n    flex-direction: column;\n    flex-wrap: nowrap;\n}\n\n.title {\n    flex: 1;\n    font-size: 18px;\n    justify-content: center;\n    margin: 0 8px;\n    overflow: auto;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.connection-status {\n    flex: 1;\n    font-weight: bold;\n    font-size: 9px;\n    justify-content: center;\n    margin: 0 8px;\n    text-transform: uppercase;\n}\n\n.connection-status.connected {\n    color: #ccff90;\n}\n\n.connection-status.connecting {\n    color: #ffeb00;\n}\n\n.connection-status.disconnected {\n    color: #e40004;\n}\n\n.header-button {\n    align-items: center;\n    border: none;\n    border-radius: 2px;\n    display: flex;\n    justify-content: center;\n    fill: #ffffff;\n    padding: 4px;\n    margin-left: 4px;\n    max-height: 24px;\n    max-width: 24px;\n}\n\n.header-button:hover {\n    filter: brightness(1.2);\n}\n\n.header-button:active {\n    filter: brightness(0.875);\n}\n\n.header-button-icon {\n    height: 16px;\n    width: 16px;\n}\n",""])},function(t,e,n){var i=n(50);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(t.exports=n(0)(!1)).push([t.i,'.conversation {\n    background: #ffffff;\n    box-sizing: border-box;\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-flex: 1;\n    -ms-flex: 1;\n    flex: 1;\n    -webkit-box-orient: vertical;\n    -webkit-box-direction: normal;\n    -ms-flex-direction: column;\n    flex-direction: column;\n    font-family: -apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Arial,sans-serif;\n    overflow: auto;\n    scroll-behavior: smooth;\n    width: 100%;\n}\n',""])},function(t,e,n){var i=n(52);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(t.exports=n(0)(!1)).push([t.i,".message-actions .action-postback {\n    background: #0099ff;\n    border-bottom: 1px solid #e6e5eb;\n    border-radius: 20px;\n    color: #fff;\n    cursor: pointer;\n    display: flex;\n    justify-content: center;\n    padding: 10px;\n    margin: 5px 10px;\n    text-decoration: none;\n}\n\n.message-actions a.action-postback:hover {\n    background: #005c99;\n}\n\n.message-actions a.action-postback:focus, .message-actions a.action-postback:active {\n    background: #004d80;\n}\n\n.message-actions a.action-postback.disabled {\n    background: #f8f8f8 !important;\n    color: #737373 !important;\n}\n\n.message-global-actions {\n    align-items: flex-start;\n    display: flex;\n    flex-direction: column;\n}\n\n.right .message-global-actions {\n    margin-left: 25px;\n}\n\n.left .message-global-actions {\n    margin-right: 25px;\n}\n\n.message-global-actions a {\n    border: 1px solid #4A90E2;\n    border-radius: 20px;\n    color: #4A90E2;\n    cursor: pointer;\n    display: inline-block;\n    margin-top: 10px;\n    padding: 8px 10px;\n    text-decoration: none;\n}\n\n.message-global-actions a:hover {\n    background: #4A90E2;\n    color: #fff;\n}\n\n.message-global-actions a:focus, .message-global-actions a:active {\n    background: #004d80;\n    color: #fff;\n}\n\n.message-global-actions a.disabled {\n    background: #f8f8f8;\n    border-color: #c5c5c5;\n    color: #737373;\n}\n",""])},function(t,e,n){var i=n(54);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(t.exports=n(0)(!1)).push([t.i,".attachment-image,\n.attachment-video{width: 100%;}\n.attachment-file{word-break: break-all;}\n.attachment-audio{width: 190px;}/* TODO: set by javascript */\n\n.attachment-message {\n    display: -webkit-flex; /* Safari */\n    display: flex;\n}\n\n.attachment-icon {\n    width: 32px;\n    height: 32px;\n    overflow: hidden;\n    margin-right: 5px;\n    justify-content: center;\n    background-color: transparent;\n    background: no-repeat center center;\n    border: none;\n    align-items: center;\n}\n\n.attachment-fileName {\n    margin: auto 0;\n}\n",""])},function(t,e,n){var i=n(56);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(t.exports=n(0)(!1)).push([t.i,".card {\n    background: #fff;\n    border: 1px solid rgba(0, 0, 0, 0.12);\n    border-radius: 20px;\n    display: block;\n    margin-bottom: 10px;\n    overflow: hidden;\n    padding: 10px 15px 10px 15px;\n    white-space: pre-wrap;\n}\n\n.card:last-of-type {\n    margin-bottom: 0;\n}\n\n.card-title {\n    font-weight: 400;\n    padding: 5px 0;\n    max-width: 100%;\n    white-space: pre-wrap;\n}\n\n.card-description {\n    font-weight: 400;\n    max-width: 100%;\n    padding: 5px 0;\n    text-overflow: ellipsis;\n    width: 375px;\n    white-space: pre-wrap;\n}\n\n.card .card-actions a {\n    border: 1px solid #e6e5eb;\n    border-radius: 20px;\n    color: #4a90e2;\n    cursor: pointer;\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-pack: center;\n    -ms-flex-pack: center;\n    justify-content: center;\n    padding: 8px 10px;\n    margin-bottom: 5px;\n}\n\n.card .card-actions-pill {\n    align-items: flex-start;\n    display: flex;\n    flex-direction: column;\n    flex-wrap: nowrap;\n    justify-content: flex-start;\n}\n\n.card .card-actions a:last-of-type {\n    margin-bottom: 0;\n}\n\n.card .card-actions a:hover {\n    background: #eaeaea;\n    color: #277adc;\n}\n\n.card .card-actions a.disabled {\n    color: #737373;\n    background: #ffffff;\n}\n\n.card .card-actions.card-actions-pill a {\n    border: 1px solid #4A90E2;\n    margin-top: 10px;\n    margin-bottom: 0;\n    text-decoration: none;\n}\n\n.card .card-actions.card-actions-pill a:hover {\n    background: #4A90E2;\n    color: #fff;\n}\n\n.card .card-actions.card-actions-pill a:active {\n    background: #004d80;\n    color: #fff;\n}\n\n.card .card-actions.card-actions-pill a.disabled {\n    background: #f8f8f8;\n    border-color: #c5c5c5;\n    color: #737373;\n}\n\n.card img {\n    height: 275px;\n    max-width: 100%;\n    width: 375px;\n}\n\n.card-message-content {\n    max-width: 100%;\n    padding-right: 15px;\n    white-space: pre-wrap;\n}\n\n.card-message-cards {\n    max-width: 100%;\n    padding-right: 10px;\n}\n\n.card-message-horizontal .card-message-cards {\n    position: relative;\n    -ms-flex-line-pack: center;\n    align-content: center;\n    white-space: pre-wrap;\n    display: inline-block;\n    width: 100%;\n}\n\n.card-message-horizontal .card {\n    width: 100%;\n    display: block;\n    white-space: pre-wrap;\n    padding: 8px;\n    margin: 0;\n}\n\n.card-message-vertical .card {\n    border-radius: 20px;\n}\n\n.card-message-vertical .message-wrapper {\n    flex-direction: column;\n}\n\n.round {\n    align-items: center;\n    background: #eaeaea;\n    border-radius: 50%;\n    -webkit-box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n    box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n    color: #333333;\n    cursor: pointer;\n    display: flex;\n    height: 30px;\n    justify-content: center;\n    margin: 5px;\n    padding: 5px;\n    position: absolute;\n    text-align: center;\n    top: 48%;\n    width: 30px;\n    z-index: 1;\n}\n\n.round svg {\n    fill: #333333;\n}\n\n.round:hover {\n    background: #4a90e2;\n    color: #ffffff;\n}\n\n.round:hover svg {\n    fill: #ffffff;\n}\n\n.previous {\n    left: -20px;\n}\n\n.next {\n    right: -10px;\n}\n",""])},function(t,e,n){var i=n(58);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(t.exports=n(0)(!1)).push([t.i,".loading-message {\n    margin-bottom: 20px;\n}\n\n.loading-icon {\n    display: -webkit-flex; /* Safari */\n    display: flex;\n}\n",""])},function(t,e,n){var i=n(60);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(t.exports=n(0)(!1)).push([t.i,".spinner{\n    position: relative;\n    display: inline-block;\n    width: 28px;\n    height: 28px;\n    margin-right: 5px;\n}\n.spinner svg{\n    animation-duration: 750ms;\n    -webkit-animation: spinner-rotate 1s linear infinite;\n    animation: spinner-rotate 1s linear infinite;\n    overflow: hidden;\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    -webkit-transform: translateZ(0);\n    transform: translateZ(0);\n}\n.spinner circle{\n    stroke: #387ef5;\n    fill: transparent;\n    stroke-width: 4px;\n    stroke-dasharray: 128px;\n    stroke-dashoffset: 82px;\n}\n\n@-webkit-keyframes spinner-rotate {\n    0% {\n        -webkit-transform: rotate(0deg);\n        transform: rotate(0deg);\n    }\n    100% {\n        -webkit-transform: rotate(360deg);\n        transform: rotate(360deg);\n    }\n}\n@keyframes spinner-rotate {\n    0% {\n        -webkit-transform: rotate(0deg);\n        transform: rotate(0deg);\n    }\n    100% {\n        -webkit-transform: rotate(360deg);\n        transform: rotate(360deg);\n    }\n}",""])},function(t,e,n){var i=n(62);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(t.exports=n(0)(!1)).push([t.i,".message-with-icon {\n    display: -webkit-flex; /* Safari */\n    display: flex;\n}\n\n.error-icon {\n    margin-right: 5px;\n    max-width: 24px;\n    max-height: 24px;\n}\n\n.message-text {\n    margin: auto 0;\n    white-space: pre-wrap;\n    word-break: break-all;\n}\n",""])},function(t,e,n){var i=n(64);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(t.exports=n(0)(!1)).push([t.i,".message {\n    margin-bottom: 20px;\n}\n\n.left {\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n    align-items: flex-start;\n}\n\n.right {\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n    align-items: flex-end;\n}\n\n.message-wrapper {\n    display: flex;\n    max-width: 100%;\n}\n\n.left .message-wrapper {\n    flex-direction: row;\n}\n\n.right .message-wrapper {\n    flex-direction: row-reverse;\n}\n\n.icon-wrapper {\n    align-self: flex-end;\n    padding: 5px;\n}\n\n.message-icon {\n    max-width: 48px;\n    max-height: 48px;\n}\n\n/*------------*/\n\n.message-profile-pic {\n    padding: 2px;\n    display: inline-block;\n    width: 25px;\n    height: 25px;\n    border-radius: 50%;\n    background-color: rgba(20, 0, 0, .12);\n    position: absolute;\n}\n\n.left .message-profile-pic {\n    bottom: 6px;\n    left: 6px;\n}\n\n.right .message-profile-pic {\n    bottom: 6px;\n    right: 6px;\n}\n\n/*------------*/\n\n.message-bubble {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    margin: 0;\n    max-width: 325px;\n    padding: 15px;\n    position: relative;\n}\n\n.message-content {\n    overflow: hidden;\n    word-wrap: break-word;\n    white-space: pre-wrap;\n}\n\n.right .message-bubble {\n    background-color: #E5F1FF;\n    margin-left: 25px;\n    border-radius: 20px 20px 0 20px;\n}\n\n.left .message-bubble {\n    background-color: #ECECEC;\n    margin-right: 25px;\n    border-radius: 20px 20px 20px 0;\n}\n\n/*------------*/\n\n.attachment-image, .attachment-video {\n    width: 100%;\n}\n\n.attachment-file {\n    word-break: break-all;\n}\n\n.attachment-audio {\n    width: 190px;\n}\n\n/* TODO: set by javascript */\n\n/* Styling of Download Button */\n/* .chat-box-download-btn {\n    float: right;\n    margin: 10px 10px;\n} */\n",""])},function(t,e,n){var i=n(66);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(t.exports=n(0)(!1)).push([t.i,".status-message-container {\n    display: flex;\n    flex-direction: column;\n}\n\n.status-message-wrapper {\n    align-self: center;\n    flex: 0 1 auto;\n    border-radius: 25px;\n    background-color: #f3f3f3;\n    max-width: 70%;\n    padding: 10px 15px;\n}\n\n.status-image {\n    margin-left: 8px;\n    margin-right: 8px;\n    max-width: 16px;\n    max-height: 16px;\n}\n\n.status-message {\n    font-size: 1.4rem;\n    color: #737373;\n    white-space: pre-wrap;\n    word-break: break-all;\n    word-wrap: break-word;\n}\n",""])},function(t,e,n){var i=n(68);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){(t.exports=n(0)(!1)).push([t.i,"\n.button:active, .button:focus, .input:active, .input:focus {\n    outline: none;\n}\n\nhr {\n    border-top: 1px solid #eee;\n    padding: 0;\n    margin: 10px 0;\n}\n",""])},function(t,e,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__rest||function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(t);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(t,i[o])&&(n[i[o]]=t[i[o]])}return n};Object.defineProperty(e,"__esModule",{value:!0});var s=n(8),r=n(70),a=n(9),c=n(71),l=n(72),h=n(2),A=n(11),u=n(14),p=n(10),d=n(15),g=n(74),f=n(75),m=n(77),_=function(){function t(t,e){var n=this;this._fetchAuthToken=e,this._logger=new h.Logger("ChatServerService"),this.onMessage=function(t,e){},this.onStatusChange=function(t){},this.onSuggestions=function(t){},this._config=this._mergeSettings(l.defaultSettings,t),this._configureLocale(),h.Logger.logLevel=this._config.isDebugMode?h.Logger.LOG_LEVEL.DEBUG:h.Logger.LOG_LEVEL.ERROR,h.Logger.appName=this._config.name,h.Logger.appVersion=this._config.version,window.addEventListener("online",function(){return n.openConnection()}),window.addEventListener("offline",function(){return n.closeConnection()}),e&&(this._authTokenService=f.AuthTokenService.getInstance(e))}return t.prototype.connect=function(){var t=this;return new Promise(function(e,n){if(t._config.clientAuthEnabled)t._authTokenService.getToken().then(function(e){return t._configureParams(e),t._url=t._setupWebSocketURI(),t._open()},function(t){return n(t)}).then(function(){return e()},function(t){return n(t)});else{try{t._configureParams()}catch(e){t._logger.error(e),n({message:e})}t._url=t._setupWebSocketURI(),t._open().then(function(){return e()},function(t){return n(t)})}})},t.prototype.uploadAttachment=function(t,e,n,i){var o=this;if(this._config.enableAttachment){this._logger.debug("upload attachment to chat server",t);var a=new FormData;a.append("attachment",t);var c=new XMLHttpRequest;c.onreadystatechange=function(){if(c.readyState===XMLHttpRequest.DONE)if(c.status===r.Response.STATUS.OK){var a=JSON.parse(c.responseText),l={attachment:{type:o._getAttachmentType(a.type.split("/")[0].toLowerCase()),url:a.url},type:p.PAYLOAD_TYPE.ATTACHMENT},h=A.createUserMessage(l,o._config.userId,new Date,!0);o.send(h,n,a.fileName)}else c.status===s.Constants.FILE_SIZE_LIMIT_EXCEEDED||c.status===s.Constants.UNSUPPORTED_FILE_TYPE?(e(t.name,c.status,n),o._logger.error("Can't upload attachment.",t,c.status)):i?o._retryUploadingFile(t,e,n):(e(t.name,c.status,n),o._logger.error("Can't upload attachment.",t))},this.isConnectionOpen()&&(this._config.clientAuthEnabled?this._authTokenService.getToken().then(function(e){o._configureParams(e),o._pushUpload(c,t,a,e)},function(t){o._logger.error("Can not upload attachment, could not get token",t)}):this._pushUpload(c,t,a))}},t.prototype.getSuggestions=function(t){if(this._logger.debug("Get suggestions from chat server",t),this._ws.readyState===WebSocket.OPEN){if(this._ws.send(JSON.stringify(t)),t.profile)return}else this._logger.error("Can't get suggestions for the user query, WebSocket status - "+s.Constants.WEBSOCKET_READY_STATE[this._ws.readyState],t)},t.prototype.isURLReachable=function(t){this._logger.debug("Check for the reachability of ",t);var e=new XMLHttpRequest;try{return e.open("HEAD",t,!1),e.send(),e.status===r.Response.STATUS.OK}catch(e){return this._logger.error("URL is not reachable: "+t),!1}},t.prototype.loadChat=function(){var t=window.localStorage.getItem(this._localStorageName)?JSON.parse(window.localStorage.getItem(this._localStorageName)):[];return t.forEach(function(t){t.isRead=!0}),window.localStorage.setItem(this._localStorageName,JSON.stringify(t)),t},t.prototype.getUnreadMessagesCount=function(){t.messages=window.localStorage.getItem(this._localStorageName)?JSON.parse(window.localStorage.getItem(this._localStorageName)):[];for(var e=0,n=0,i=t.messages;n<i.length;n++){var o=i[n];o.from&&!o.isRead&&e++}return e},t.prototype.send=function(t,e,n){if(this._wsSend(t)){if(t.profile)return;if(t.messagePayload&&t.messagePayload.type===p.PAYLOAD_TYPE.POSTBACK){var i=A.createUserMessage({text:t.messagePayload.text,type:p.PAYLOAD_TYPE.TEXT},this._config.userId,new Date,!0);i.userId=this._config.userId,this._saveMessage(i),this.onMessage(i)}else n&&(t.messagePayload.attachment.fileName=n),this._saveMessage(t),this.onMessage(t,e)}else this._logger.error("Can't send message, WebSocket status - "+s.Constants.WEBSOCKET_READY_STATE[this._ws.readyState],t)},t.prototype.markAsRead=function(e){t.messages=window.localStorage.getItem(this._localStorageName)?JSON.parse(window.localStorage.getItem(this._localStorageName)):[];for(var n=0,i=0,o=t.messages;i<o.length;i++){var s=o[i];if(new Date(s.date).getTime()===new Date(e).getTime()){s.isRead=!0,t.messages[n]=s;break}n++}window.localStorage.setItem(this._localStorageName,JSON.stringify(t.messages))},t.prototype.retryMessage=function(t){var e=t.messagePayload;if(this._latestUserMessage)this._latestUserMessage.date=new Date,this.send(this._latestUserMessage);else if(e&&e.postback.text){var n={text:e.postback.text,type:p.PAYLOAD_TYPE.TEXT},i=A.createUserMessage(n,this._config.userId,new Date,!0);this.send(i)}},t.prototype.getChatConfiguration=function(){return this._config},t.prototype.setSettingsProperty=function(t,e){this._config[t]=e},t.prototype.isConnectionOpen=function(){return this._ws&&this._ws.readyState===WebSocket.OPEN},t.prototype.openConnection=function(){return this.isConnectionOpen()&&this.closeConnection(),this.connect()},t.prototype.closeConnection=function(t,e){this.isConnectionOpen()&&this._ws.close(t,e)},t.prototype.updateUser=function(t){this.send(t)},t.prototype._configureParams=function(t){if(this._config.clientAuthEnabled?(this._config.channelId=t.getClaim("channelId"),this._config.userId=t.getClaim("userId")):this._config.userId=this._config.userId||this._generateUserId(),!this._config.URI)throw new Error("URI not provided.");if(!this._config.channelId)throw new Error("channelId not provided.");if(!this._config.userId)throw new Error("userId not provided.");this._localStorageName=this._config.name+"-"+this._config.userId+"-messages"},t.prototype._open=function(){var t=this;return new Promise(function(e,n){t._ws=new m.ReconnectingWebSocket(t._url.toString(),t._config.clientAuthEnabled?t._authTokenService:void 0,t._config.reconnectInterval,t._config.reconnectMaxAttempts,t._config.reconnectTimeout,"https://"+t._config.URI+"/v1/poll/messages"),t._ws.onopen=function(){if(t._logger.debug("WebSocket opened"),t._config.initUserHiddenMessage){var n={text:t._config.initUserHiddenMessage,type:p.PAYLOAD_TYPE.TEXT};t._wsSend(A.createUserMessage(n,t._config.userId,new Date,!0))}e()},t._ws.onmessage=t._wsMessage.bind(t),t._ws.onclose=function(){t._logger.debug("WebSocket closed"),n()},t._ws.onerror=function(e){t._logger.error("WebSocket error",e)},t._ws.onstatuschange=function(e){t.onStatusChange(e)}})},t.prototype._pushUpload=function(t,e,n,i){var o=this._setupAttachmentURI();t.open("POST",o.toString()),t.setRequestHeader(s.Constants.FILE_SIZE_METADATA_HEADER,e.size.toString()),this._config.clientAuthEnabled&&t.setRequestHeader("Authorization","Bearer "+i.token),t.send(n)},t.prototype._retryUploadingFile=function(t,e,n){this.uploadAttachment(t,e,n)},t.prototype._getAttachmentType=function(t){switch(t){case u.ATTACHMENT_TYPE.IMAGE:case u.ATTACHMENT_TYPE.VIDEO:case u.ATTACHMENT_TYPE.AUDIO:return t;default:return u.ATTACHMENT_TYPE.FILE}},t.prototype._generateUserId=function(){var t=new Date;return"user"+1e4*(Math.random()+Date.parse(t.toDateString())+t.getTime())%1e8},t.prototype._setupWebSocketURI=function(){var t=this._config.enableSecureConnection?"wss://":"ws://",e=new URL(t+this._config.URI+"/chat/v1/chats/sockets/websdk"),n=e.search,i=new URLSearchParams(n);return i.set("channelId",this._config.channelId),i.set("userId",this._config.userId),e.search=i.toString(),e},t.prototype._setupAttachmentURI=function(){var t=this._config.enableSecureConnection?"https://":"http://",e=new URL(t+this._config.URI+"/chat/v1/attachments"),n=this._url.search,i=new URLSearchParams(n);return i.set("channelId",this._config.channelId),i.set("userId",this._config.userId),e.search=i.toString(),e},t.prototype._wsSend=function(t){if(this._logger.debug("Message to chat server",t.messagePayload),this._config.delegate&&(this._config.delegate.beforeSend&&a.utils.isFunction(this._config.delegate.beforeSend)&&t.messagePayload&&t.messagePayload.type===p.PAYLOAD_TYPE.TEXT?t.messagePayload=this._config.delegate.beforeSend(t.messagePayload):this._config.delegate.beforePostbackSend&&a.utils.isFunction(this._config.delegate.beforePostbackSend)&&t.messagePayload&&t.messagePayload.type===p.PAYLOAD_TYPE.POSTBACK&&(t.messagePayload=this._config.delegate.beforePostbackSend(t.messagePayload)),!t.messagePayload))return!1;this._latestUserMessage=t;t.isRead,t.date;var e=o(t,["isRead","date"]);return this._ws.readyState===WebSocket.OPEN?this._ws.send(JSON.stringify(e)):this._logger.error("Can't send message, WebSocket status - "+s.Constants.WEBSOCKET_READY_STATE[this._ws.readyState],t),this._ws.readyState===WebSocket.OPEN},t.prototype._wsMessage=function(t){var e,n,i;this._logger.info("Message received: ",t.data);try{var o=JSON.parse(t.data);if(o.suggestions?i=!0:(i=!1,n=o.type),d.isPongMessage(o))return;if(this._config.delegate&&this._config.delegate.beforeDisplay&&a.utils.isFunction(this._config.delegate.beforeDisplay)&&(o.messagePayload=this._config.delegate.beforeDisplay(o.messagePayload),!o.messagePayload))return;e=o}catch(i){(e={date:new Date,isRead:!1}).text=t.data,n="error"}if(i)this.onSuggestions(e);else{if(e.from={type:g.SENDER_TYPE.BOT},e&&(e.text||e.choices)){var s=A.createBotMessage(e.from,{actions:[],text:e.text,type:p.PAYLOAD_TYPE.TEXT},new Date,!1);if("error"===n){var r=this._config.i18n[this._config.locale?this._config.locale:"en-US"].retryMessage;s.messagePayload.actions.push({actionId:"Retry",label:r,postback:this._latestUserMessage.messagePayload,text:r,type:"postback"})}if(e.choices)for(var c=0,l=e.choices;c<l.length;c++){var h=l[c];s.messagePayload.actions.push({label:h,postback:h,type:"postback"})}e=s}else e.from&&e.to&&delete e.from;e.date=new Date,e.isRead=!1,this._config.enableNotification&&new Audio(this._config.notificationAudioURL).play(),this._saveMessage(e),this.onMessage(e)}},t.prototype._saveMessage=function(e){t.messages=window.localStorage.getItem(this._localStorageName)?JSON.parse(window.localStorage.getItem(this._localStorageName)):[],t.messages.length>=this._config.messageCacheSizeLimit?(t.messages=t.messages.slice(1,this._config.messageCacheSizeLimit),t.messages.push(e)):t.messages.push(e),window.localStorage.setItem(this._localStorageName,JSON.stringify(t.messages))},t.prototype._mergeSettings=function(t,e){var n=i(i({},t),e);if(e.i18n&&Object.keys(e.i18n).length){t.i18n=this._convertKeysToLowerCase(t.i18n),e.i18n=this._convertKeysToLowerCase(e.i18n);var o=new Set;Object.keys(t.i18n).forEach(function(t){o.add(t)}),Object.keys(e.i18n).forEach(function(t){o.add(t)}),n.i18n={},o.forEach(function(o){n.i18n[o]=i(i(i({},t.i18n["en-us"]),t.i18n[o]),e.i18n[o])})}return n.colors=i(i({},t.colors),e.colors),n},t.prototype._convertKeysToLowerCase=function(t){for(var e={},n=0,i=Object.entries(t);n<i.length;n++){var o=i[n],s=o[0],r=o[1];e[s.toLowerCase()]=r}return e},t.prototype._configureLocale=function(){var t=c.webApi.getBrowserLocale();this._isLocaleTranslationsPresent(t)?this._config.locale=t.toLowerCase():this._isLocaleTranslationsPresent(this._config.locale)?this._config.locale=this._config.locale.toLowerCase():this._config.locale="en-us"},t.prototype._isLocaleTranslationsPresent=function(t){for(var e in t=t.toLowerCase(),this._config.i18n)if(e.toLowerCase()===t)return!0;return!1},t}();e.ChatServerService=_},function(t,e,n){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.OK=200]="OK"}(i||(i={}));var o=function(){function t(){}return t.STATUS=i,t}();e.Response=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.webApi={getBrowserLocale:function(){return navigator.language},isLocalStorageAvailable:function(){return i("localStorage")},isLocationServiceAvailable:function(){return"geolocation"in navigator}};var i=function(t){var e;try{e=window[t];var n="__storage_test__";return e.setItem(n,n),e.removeItem(n),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&e&&0!==e.length}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.defaultSettings={audioIcon:'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="%2341bfec" d="M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm7 7V3.5L18.5 9H13z"/></svg>',autoplayAudio:!1,autoplayVideo:!1,badgePosition:{right:"0",top:"0"},botButtonIcon:'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 48 48"><path d="M0 24a24 24 0 1 0 48 0 24 24 0 1 0-48 0" fill="%231b8fd2" opacity=".8"/><path d="M32.25 31.084h-7.532L19.2 37.021a1.061 1.061 0 0 1-1.251-1.316l.031-4.622h-1.23C12.47 31.084 9 28.372 9 23.97A7.862 7.862 0 0 1 16.75 16h15.5A7.862 7.862 0 0 1 40 23.97c0 4.402-3.47 7.114-7.75 7.114zM16.531 20.938a2.594 2.594 0 1 0 2.594 2.594 2.594 2.594 0 0 0-2.594-2.594zm7.969-.031a2.594 2.594 0 1 0 2.594 2.593 2.594 2.594 0 0 0-2.594-2.594zm7.969.031a2.594 2.594 0 1 0 2.594 2.594 2.594 2.594 0 0 0-2.594-2.594z" fill="%23fff" fill-rule="evenodd"/></svg>',chatBubbleIconHeight:"42px",chatBubbleIconWidth:"56px",clientAuthEnabled:!1,colors:{action:"#4A90E2",branding:"#1B8FD2",text:"#212121",textLight:"#737373"},conversationBeginPosition:"top",delaySuggestionsFetch:300,disablePastActions:"all",displayActionsAsPills:!1,embedded:!1,embeddedVideo:!0,enableAttachment:!0,enableAutocomplete:!1,enableBotAudioResponse:!1,enableClearMessage:!1,enableLocalConversationHistory:!1,enableNotification:!1,enableSecureConnection:!0,enableTimestamp:!0,errorIcon:'data:image/svg+xml;utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><title>stat_error_16</title><circle cx="8" cy="8" r="8" fill="%23e4001e"/><path d="M11.686,5.817a1.063,1.063,0,0,0-1.5-1.5L8,6.5,5.818,4.314a1.063,1.063,0,0,0-1.5,1.5L6.5,8,4.314,10.183a1.063,1.063,0,0,0,1.5,1.5L8,9.5l2.183,2.183a1.063,1.063,0,0,0,1.5-1.5L9.5,8Z" fill="%23fff"/></svg>',fileIcon:'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="%2341bfec" d="M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm7 7V3.5L18.5 9H13z"/></svg>',font:'16px "Helvetica Neue", Helvetica, Arial, sans-serif',height:"70vh",i18n:{"en-us":{audioResponseOff:"Audio response off",audioResponseOm:"Audio response on",cardImagePlaceholder:"Loading image",chatTitle:"Ask",clear:"Clear",close:"Close",closing:"Closing",connected:"Connected",connecting:"Connecting",disconnected:"Disconnected",inputPlaceholder:"Type a message",previousChats:"Previous conversations",requestLocation:"Requesting location",requestLocationString:"Cannot access your location. Please allow access to proceed further.",retryMessage:"Try again",send:"Send",upload:"Upload Document",uploadFailed:"Upload Failed.",uploadFileSizeLimitExceeded:"Upload Failed. File size should not be more than 25MB.",uploadUnsupportedFileType:"Upload Failed. Unsupported file type."}},imageIcon:'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="%2341bfec" d="M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm7 7V3.5L18.5 9H13z"/></svg>',isDebugMode:!1,locale:"en-us",logoIcon:'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" fill="%23FFFFFF" width="24" height="24" viewBox="0 0 24 24"><path d="M18,16.99H11.733L8,21.125a1.119,1.119,0,0,1-1.021-1.36V16.99H6a5.849,5.849,0,0,1-6-5.87A6.061,6.061,0,0,1,6,5H18a6.061,6.061,0,0,1,6,6.12A5.849,5.849,0,0,1,18,16.99ZM6,9a2,2,0,1,0,2,2A2,2,0,0,0,6,9Zm6,0a2,2,0,1,0,2,2A2,2,0,0,0,12,9Zm6,0a2,2,0,1,0,2,2A2,2,0,0,0,18,9Z"/></svg>',maxAttachmentFileSize:25,messageCacheSizeLimit:2e3,messagePadding:"15px",name:"oda-chat",notificationAudioURL:"data:audio/ogg;base64,T2dnUwACAAAAAAAAAADSeWyXAAAAAHTSMw8BHgF2b3JiaXMAAAAAAkSsAAD/////APQBAP////+4AU9nZ1MAAAAAAAAAAAAA0nlslwEAAACM6FVoEkD/////////////////////PAN2b3JiaXMNAAAATGF2ZjU2LjIzLjEwNgEAAAAfAAAAZW5jb2Rlcj1MYXZjNTYuMjYuMTAwIGxpYnZvcmJpcwEFdm9yYmlzKUJDVgEACAAAgCJMGMSA0JBVAAAQAACgrDeWe8i99957gahHFHuIvffee+OsR9B6iLn33nvuvacae8u9995zIDRkFQAABACAKQiacuBC6r33HhnmEVEaKse99x4ZhYkwlBmFPZXaWushk9xC6j3nHggNWQUAAAIAQAghhBRSSCGFFFJIIYUUUkgppZhiiimmmGLKKaccc8wxxyCDDjropJNQQgkppFBKKqmklFJKLdZac+69B91z70H4IIQQQgghhBBCCCGEEEIIQkNWAQAgAAAEQgghZBBCCCGEFFJIIaaYYsopp4DQkFUAACAAgAAAAABJkRTLsRzN0RzN8RzPESVREiXRMi3TUjVTMz1VVEXVVFVXVV1dd23Vdm3Vlm3XVm3Vdm3VVm1Ztm3btm3btm3btm3btm3btm0gNGQVACABAKAjOZIjKZIiKZLjOJIEhIasAgBkAAAEAKAoiuM4juRIjiVpkmZ5lmeJmqiZmuipngqEhqwCAAABAAQAAAAAAOB4iud4jmd5kud4jmd5mqdpmqZpmqZpmqZpmqZpmqZpmqZpmqZpmqZpmqZpmqZpmqZpmqZpmqZpmqZpQGjIKgBAAgBAx3Ecx3Ecx3EcR3IkBwgNWQUAyAAACABAUiTHcixHczTHczxHdETHdEzJlFTJtVwLCA1ZBQAAAgAIAAAAAABAEyxFUzzHkzzPEzXP0zTNE01RNE3TNE3TNE3TNE3TNE3TNE3TNE3TNE3TNE3TNE3TNE3TNE3TNE1TFIHQkFUAAAQAACGdZpZqgAgzkGEgNGQVAIAAAAAYoQhDDAgNWQUAAAQAAIih5CCa0JrzzTkOmuWgqRSb08GJVJsnuamYm3POOeecbM4Z45xzzinKmcWgmdCac85JDJqloJnQmnPOeRKbB62p0ppzzhnnnA7GGWGcc85p0poHqdlYm3POWdCa5qi5FJtzzomUmye1uVSbc84555xzzjnnnHPOqV6czsE54Zxzzonam2u5CV2cc875ZJzuzQnhnHPOOeecc84555xzzglCQ1YBAEAAAARh2BjGnYIgfY4GYhQhpiGTHnSPDpOgMcgppB6NjkZKqYNQUhknpXSC0JBVAAAgAACEEFJIIYUUUkghhRRSSCGGGGKIIaeccgoqqKSSiirKKLPMMssss8wyy6zDzjrrsMMQQwwxtNJKLDXVVmONteaec645SGultdZaK6WUUkoppSA0ZBUAAAIAQCBkkEEGGYUUUkghhphyyimnoIIKCA1ZBQAAAgAIAAAA8CTPER3RER3RER3RER3RER3P8RxREiVREiXRMi1TMz1VVFVXdm1Zl3Xbt4Vd2HXf133f141fF4ZlWZZlWZZlWZZlWZZlWZZlCUJDVgEAIAAAAEIIIYQUUkghhZRijDHHnINOQgmB0JBVAAAgAIAAAAAAR3EUx5EcyZEkS7IkTdIszfI0T/M00RNFUTRNUxVd0RV10xZlUzZd0zVl01Vl1XZl2bZlW7d9WbZ93/d93/d93/d93/d939d1IDRkFQAgAQCgIzmSIimSIjmO40iSBISGrAIAZAAABACgKI7iOI4jSZIkWZImeZZniZqpmZ7pqaIKhIasAgAAAQAEAAAAAACgaIqnmIqniIrniI4oiZZpiZqquaJsyq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7rukBoyCoAQAIAQEdyJEdyJEVSJEVyJAcIDVkFAMgAAAgAwDEcQ1Ikx7IsTfM0T/M00RM90TM9VXRFFwgNWQUAAAIACAAAAAAAwJAMS7EczdEkUVIt1VI11VItVVQ9VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV1TRN0zSB0JCVAAAZAADDtOTScs+NoEgqR7XWklHlJMUcGoqgglZzDRU0iEmLIWIKISYxlg46ppzUGlMpGXNUc2whVIhJDTqmUikGLQhCQ1YIAKEZAA7HASTLAiRLAwAAAAAAAABJ0wDN8wDL8wAAAAAAAABA0jTA8jRA8zwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACRNAzTPAzTPAwAAAAAAAADN8wBPFAFPFAEAAAAAAADA8jzAEz3AE0UAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABxNAzTPAzTPAwAAAAAAAADL8wBPFAHPEwEAAAAAAABA8zzAE0XAE0UAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAABDgAAARZCoSErAoA4AQCHJEGSIEnQNIBkWdA0aBpMEyBZFjQNmgbTBAAAAAAAAAAAAEDyNGgaNA2iCJA0D5oGTYMoAgAAAAAAAAAAACBpGjQNmgZRBEiaBk2DpkEUAQAAAAAAAAAAANBME6IIUYRpAjzThChCFGGaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIABBwCAABPKQKEhKwKAOAEAh6JYFgAAOJJjWQAA4DiSZQEAgGVZoggAAJaliSIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAEHAIAAE8pAoSErAYAoAACHolgWcBzLAo5jWUCSLAtgWQDNA2gaQBQBgAAAgAIHAIAAGzQlFgcoNGQlABAFAOBQFMvSNFHkOJalaaLIkSxL00SRZWma55kmNM3zTBGi53mmCc/zPNOEaYqiqgJRNE0BAAAFDgAAATZoSiwOUGjISgAgJADA4TiW5Xmi6HmiaJqqynEsy/NEURRNU1VVleNolueJoiiapqqqKsvSNM8TRVE0TVVVXWia54miKJqmqrouPM/zRFEUTVNVXRee53miKIqmqaquC1EURdM0TVVVVdcFomiapqmqquq6QBRF0zRVVVVdF4iiKJqmqqqu6wLTNE1VVVXXlV2Aaaqqqrqu6wJUVVVd13VlGaCqquq6rivLANd1XdeVZVkG4Lqu68qyLAAA4MABACDACDrJqLIIG0248AAUGrIiAIgCAACMYUoxpQxjEkIKoWFMQkghZFJSKimlCkIqJZVSQUilpFIySi2lllIFIZWSSqkgpFJSKQUAgB04AIAdWAiFhqwEAPIAAAhjlGKMMeckQkox5pxzEiGlGHPOOakUY84555yUkjHnnHNOSumYc845J6VkzDnnnJNSOuecc85JKaV0zjnnpJRSQugcdFJKKZ1zDkIBAEAFDgAAATaKbE4wElRoyEoAIBUAwOA4lqVpnieKpmlJkqZ5nueJpqpqkqRpnieKpqmqPM/zRFEUTVNVeZ7niaIomqaqcl1RFEXTNE1VJcuiaIqmqaqqC9M0TdNUVdeFaZqmaaqq68K2VVVVXdd1Yduqqqqu68rAdV3XdWUZyK7ruq4sCwAAT3AAACqwYXWEk6KxwEJDVgIAGQAAhDEIKYQQUsggpBBCSCmFkAAAgAEHAIAAE8pAoSErAYBUAACAEGuttdZaaw1j1lprrbXWEuestdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbVWACB2hQPAToQNqyOcFI0FFhqyEgAIBwAAjEGIMegklFJKhRBj0ElIpbUYK4QYg1BKSq21mDznHIRSWmotxuQ55yCk1FqMMSbXQkgppZZii7G4FkIqKbXWYqzJGJVSai22GGvtxaiUSksxxhhrMMbm1FqMMdZaizE6txJLjDHGWoQRxsUWY6y11yKMEbLF0lqttQZjjLG5tdhqzbkYI4yuLbVWa80FAJg8OABAJdg4w0rSWeFocKEhKwGA3AAAAiGlGGPMOeeccw5CCKlSjDnnHIQQQgihlFJSpRhzzjkIIYRQQimlpIwx5hyEEEIIpZRSSmkpZcw5CCGEUEoppZTSUuuccxBCCKWUUkopJaXUOecghFBKKaWUUkpKLYQQQiihlFJKKaWUlFJKIYRQSimllFJKKamllEIIpZRSSimllFJSSimFEEIppZRSSimlpJRaK6WUUkoppZRSSkkttZRSKKWUUkoppZSSWkoppVJKKaWUUkopJaXUUkqllFJKKaWUUkpLqaWUSimllFJKKaWUlFJKKaVUSimllFJKKSml1FpKKaWUSimllFJaaymlllIqpZRSSimltNRaay21lEoppZRSSmmttZRSSimVUkoppZRSAADQgQMAQIARlRZipxlXHoEjChkmoEJDVgIAZAAADKOUUkktRYIipRiklkIlFXNQUooocw5SrKlCziDmJJWKMYSUg1QyB5VSzEEKIWVMKQatlRg6xpijmGoqoWMMAAAAQQAAgZAJBAqgwEAGABwgJEgBAIUFhg4RIkCMAgPj4tIGACAIkRkiEbEYJCZUA0XFdACwuMCQDwAZGhtpFxfQZYALurjrQAhBCEIQiwMoIAEHJ9zwxBuecIMTdIpKHQgAAAAAgAMAPAAAJBtAREQ0cxwdHh8gISIjJCUmJygCAAAAAOAGAB8AAEkKEBERzRxHh8cHSIjICEmJyQlKAAAggAAAAAAACCAAAQEBAAAAAIAAAAAAAQFPZ2dTAAQAWgAAAAAAANJ5bJcCAAAAgj7NLiU1/yA4MrTSmOluanqbtcPY/w//Af8U/xX/Fv8o/yL/Jv81/yYB9CSz/hJutS5S5uELBR8L66hMbCYB6MjXvbm6N4IgSjhP7Ni7XXFc7HctclM1G+vWvr5XYQAyllz7LOFFS20ZEloiGEuufZHwolJbhoIF3hCiUpFlWa1WcwKzs5mKzVXFlAZVxQoA4EWMjRg1xqiUMexaF1uDNRiGo6pYHAmCiGLHtCLBCqPGGdEuFEgYWgNIfUSbgUHqpLMkba+Ox3YcV0HntMBK9JVIkcQkGUSlqCOxiCUI1EQCkr79gl021AC+q0GQFLgfhlyTuqurXnmbGkVBatGzTAZLpKalRNAuyIBJtXMq1xe7iqbsosaOZ8DMxCHp2iMMdEPSe6vrEduzRm23HTupx70trpwqqjvluaGIERghMJ/ty3jvZxVrv+XlVmP/Oue72/1TtbvC/nyvd/l5nYY8oCEEDWpoMLQR3iIgA3DBDRh8zNrQmjpdAVYF11gRACxSpctbnjn0FqnS9S33HLjnAnBKKYQSgKkphnq9SozzuqLeoVEk8T4zztsxvp1xX7dXM0V4ay0D3JLLdolfAb8ll+0SvwJxVtaESIlT4g5grYhaY/qr42nn19PO6vHK4MjskS8tPaFwEAUaKb6EFwkP4gITiBRfwouEB3GBCRxFTrudCgB0CF0RHTqJDsPQESMEAAAAAABA1LA6WBwcHS1WmxWH2nIkABhYMtKYmRvpdXqdXqfXaCPRSDQSjUSDMDCgqnqqoNmmVi/bAv5jyoQPgkyIKv4IIwOAjMKbzAY285LMx7e3OFBeGnyiiQ1gMXJggCQCIFgpI8tMQJjXTQPQVUAzkADSgKR4JMMHQFcBYcllcFzCZOMBATgIvAN+Gd7zj+Pd1PpG28BleM8/j3cX6xsmcAOtVi+BjUeHa4m7GIahoxgLAAAAAAAOWK1qGKJWUxxV7ajdqmKgpopFTLtpYcuKWrXEigWWllhYyNGQSEBoFOCwmrfjnHF7Nr2aT7pJhkTuv4YrG2fSU92xBdyU+yw0CuTYSMQhbuoMFXMfO47je61IYyMJD1qwLQGDRGhawihYsJFu8ibHTdIL6ZLWPN+JZN1kXXPyouTnSYokvcg3ItfzpENX1l4nEK3n4KT9mbaMsm5LfNQBjswpUQC+OX6is+iveiTYkQCb4xc6ivaoR4IdCfAHAAAA4CGTYYphGAYJyAYAAAAAAAAAAACRlSYAQEhVkQiJwFBjURpZ0CiGUgiJkAjJL1aMmAMA70ggI2Vo0OAhGN0aAJnwABe6SFaABbKAxFEYrCqNIKlobWTmLiF8ljVlVu3Eb5Iwcoc+WokPNBi1DjrQKAaABSzoCwCABQAALl4ZnjZ8l29TJuywoDI8bfgu36ZM2GHBW0RmADLrmRyJySN0SAzDNWQykaoKAAAAANZaNVasGlSNtYJpFbvF0bBaxIqFqCKOBpEwjATRMKKoI0QJCBU4VOAw9tibMAiDMGi3tubO7e7NNTmxx9zN3Vx0ikgksv/q1avNnPyu7/oIbGks2ZIdra5QFrIrsyALsiALUjTu5/pycmLBzd3czUUkEolIIY+bLMiCFE0++eSTz30pkkseySOtXjCpVKp0vHTu3F6v19frJaPxkXoksq+x+5vrtYH12nApK5VK1VJeptdz9LSHalAA/hjeM1dJs9SvRnrOenw8hvfMVdIs9avhOevx8gcAAAAAAABkMshkkIBsAEAAAAAAAAAAAFFJaEkAACAlAtVAo1oWBmZojcxNTC0KAICLC0AoJOtJRV+hLA6hMrCr+g4swBCAAmUuQPkBoAEADgDeCN4zV0mz1KuQnruOj0bwkb1KmqFeBc9dj48/AAAAAAAAMAzDIBsAAAMAAAAAAAAAGiQyGgAAQCBRVGlsSU2mAlWjGmkVnQAAADQsH8saKpHAMhSManQF9A6v48auUQcAVAMAhmUugAYB3ug9Mjep61afDWPXgEbvkblJXbf4aBinHvgDAAAAAAAggWEYhmEQCAABAQAAAAAAQDZJyAYAAJAIVJWWbZoYVotI1VQaSRMkAFwA0AADQAET7osFCn25VjuXuj0W3lu14wv2AoxhYIEGDABohgVgAYADAHAOUAAHiAA+yF2zN4lrV58FY9eBQe6avUlcu/osGLse+AMAAAAAACCBYViWoSNGqBgAAAAAAIASJGQLAACAQAojVWPF5JMkFyNVaS6lBSSAhc4LAGyfCn3PVHNt7fCW67yv3kd98Hl9TM/Wsq8+ZA4vL/vLE9pMuNvRKJH/DduZWQDWGlYF+dBV+3oHVw7A0QA4TAZ3Sw6AA5A2CTTyd7P5AD6YPTI3KWsXvzW0U8eVweyRuUlZu/jVME498AcAAAAAAGAYNiWGUVUxAAAAAABQA5AtAAAgkAh8Wd3C8duyXoPEkk5vCQkgBxoATTKJhkjHW2bR03Up81cjO7FEayY18anKnBanNiTLjPvr5n2TpZDhm1prmswUMyydE6b9a7dVMwvVwqSlYn5ZscOzUNaigSRlSE4BMawVTFoOsWGJyhPaqEnjNWXUhWye/Fn/+YuW03XAYAG+d11zd8nnFp8Ndg3Yu+65m+Szi88Guwb8AQAAAAAACQzDJqYYVYkYAwAAAAAQTQmikQAAgBBInbFiIDUajQBjI0sWkAAAoH+4ODCosWuG2qOhy6pxuvGnZNUth5mD9OqfiExBT95kwWYqSQbgmaIQW1v3pt1xrK4FjKW5R3lS83aRAqp392QV0M2bJPTsoip7KGYe6f3PT3yrWsVEe5Fa1srwYl4RSfPnpW5GWmfO1pW0TiKuDvZ6O9diIMO644R0xgB+V91zV4nnVq8Bsx64q665m8R9V68Box74AwAAAGAAJLBsFVuliqoYAAAAAIBoAEpJAAAphQ1C6LTmpqYWhBBSbywMAIAMgPkAd2DYpQKqJ2m4S7RiaB3vx7iQh+ovBqp3kztJXragwdXvKfoUkHcBYvgmSO5srpyc7mR002McEgVP9cyQXZ54yHP10nLlhnWOj3b+c3vn5BeZG1AXucuTnIdlkAEbEAP6d0rd2leSard/j1k1cbWfVermjFyIzJF0kXZlGSxiQMLSNizSw51z9ZRxqCKAHAAeN30PThKWq49Gkerg2jZ9DM3/CvXRSErdGtc/AAAAACAhV42qqqQBVaIKAAAAQM0QUDIBABBSIqShYmzJVG+KomjNEFoBAIA2F8Y5SeX+8GabWefCmtzlBVUtWRBXJ0zCmTxnhoyfh5nkHR2Fo2PPHBhVTtVpNTFcSf1btS1R/QJtOpHZquwfJInrFK7LRYM1M4zrhaIr2XLPJe0q7Q2P8akOp0jyjKjN0vEjzSghnUVF6srZBhKoDz33DN3ZNN1VTD7WGENCvi+IIEEyv//81b9uyNmLvyTVN9afJ/bK7r8c2vfkAyQuSQJM8mUR4/MHrWw258zy7WqZmVB4zNESZZv2ll9icNByaECDDACeB/2VLxK7DI9J1GL6SMmD/spXSR33mhBi8sAfAAAAANhKxRTLVlJVFSMQAAAAQKkERBMAIACQUmc41Yokoi5VCK1iYGwOAAAVAMjJKjQV01d6HmogGWa3uCFhq+eAWN5qJzk1dXyzKMc7f1nNOJ3166VeTUkc3ncOhRr1d1b9dwJhfvq9h06x6asm0//pCAiqds0IzGRKSLjjooK58vqRyBnSvj89XdA4JmmoZtHSTK19OgsXFP1/mPPJMowKaLKu7BfGnU4vPEkw9difiZHxSF/zRWz/vumfdxHwdEtXU+zlwjMepYK4OZdeP3td5jGOPb0g41l/sRVUMD45AIcNPuf8ziVJnXQNEFsPzDm/81VSJzwGCBX8AQAAADCS8mArjWKbqqoqBgAAALQQAZoBACAFSIRMyFgpfup2BUBNcuc6kgUABJicAwm14jeHykz69VS8687Rr7/Xpv8kz8q2fpansrkAmTeXRKBBRGTTP+eR2/+eWys+ufGvq5Kz6SeovGvXaanow+ydO0tK9vcvuj/byqhjMqfXDqmXW4/LJGbp8Q2LS1aSSVVfp4ISCUXPrprLxNMNB9hX9y2eWVveN5OzqK/ceU4zVPbKeVrKzBoYZI0PgIQsihsTjnS07oX52c/CZnr8lUEXf2ISIfXSKxVMpKiZSHl0w63OrhOpqq0jH4B8PYs+mgMyGCFncBmqBAX+xvzKeklNhlcDsXXAG/MzVyR2wscA4YM/AAAAALKZysVJVSmpGgwqBgAAAGpGgJoBADYSABkv71JHy/nyeTluxu8rogUAaQAAqGahuSVtte9O8unS+/sM4WRRPQyXYuiO47jP15meSzmez2MRLPk8WQ9+uCCKCeO6+AJxPpMalfmCo0zP8OqcFdV8vmQyXgAHnA/jLnc2UEKF6iHffd8u/qXKrg1FDoeZ1PlqqBuQUS4UkE7qpG5czz8hk4JzevZknqgmvxdrPDJ9MSpmc56ZXYUiT65I8bt9mzEFu+fPm/vftSK3mJf0kHh52gh+Z/A5O4K1HJ++boy6mUBGpT48CoQJYqfCPaT18QGQl8JzUzOguQGelnwNRAl3wsdIEHEZ0pLPgSLxJnyMBOFX4AMAkTOaLosqom6dIgAy2WIqF1vFqKpBFQAAAFRACXLfaFS1FkEVAA6AQbXAUaIPbMqXOEsHJwSo2bw74sBSOeOnO6t6yLJLKTbW9Dq+7eq7FmbwDFf19kxh5+Yse8iuXVVvga0YhsLu+uM881wFkLymlo7jyhLPwFDcW8VVULywnqxnDOuXFTfZynuAvp1NUe9nBz0toKuyEW/j2qY1TUPVM3QuPPhUAkxnvF/nb1895wYvguSDly/z/7skF9+x326O6zyRPiq+pfsYO56YyktxS9vmelMOqbrxmSjfLjMiuLj/Tkq1BcesV4RqMhM/k3KmS2U8XJvvQRADnpZ8ZdP3IayzQcQgLfnOxs9N6GeDiMEfAAAAoMlW5UrFsklVVRUAAADIQoICAIQqQCKEh3ffbRv67SmkVMwxNJEAACgkEgoAAJZlyRHresrdNelLKA9qcx/PNJ3ROtU1edcIHoplF1VbTdx4lw51V+tctezY0w83Tynt0lPxXaeppzqPBUpXrQcHaCqmvxrorpnrCzj0/63i3n0dGIo6OdsrbCg23WRRTfdAliC1l/aBeRec9Ns6syVWQiQyBw+7S1/1oGPbPL6rRJ+hk1TTPXdxpnWu3jsvpMwDV2v/8obdH1fSdv/GfpuXVv8a+5a+bb0NjZn+Hy+3eL/lpsTMjElt7lKp74cx5lVc+J0ecZyXhNoT/nYe39WJQ/v/E0/IZm5ugw0DAJ6WfFlJ4k9aJQg1LaQl37aX+JMWA8JPFX4AAJWsBoozVAOwxVZVsZWSqqoqBgAAIGupqwr5XAUAgEQAIKVB8ZC88bpRM7quKb5O9s+zTCfVXF0oduZ71zk69ox25k73pUMdT5eK4hzwVN+U+BcVT+7GKHYzI/Yoz2ZmISly6jd1vkP2pmvSVeuH65lGY3W0L7smc7qqORON5kzFLJWmGRhltwusXDITJn2/xg/3o4bpXfOYJAf956Z5G1TVtlDDUAXP3dSMG2bf6UbeVa1QhjnMjkX1sGfiocx1A2T30SkvSs+NnG+uVPe0zfHfghTZfMfMd/bLuauitdS29qrPYlrq98+VRAa3JFZNeS8f8DTqGVFz0oqCoBDZCGv8k4C6DABelnxyUSRIegggNYwl72QREZEeKAAfAJB1yiwzyPplFahUOVdVJTooaqRKVAAAAAAAI8GxgkXMc7YKAACokmQ6KjyE+3088Jm2lr27+vTztobbIQ6fJM2Bqax5WU7gCjldlUqK3E920lD7ETV5XxllFpWjrykA3lJZ/HbRfeLUGc68fDM5tQGcFvQkEQzKaRprHEGOKJAmWg1UInLy/OkiZ7sSJ2hv591dc2Hx5AYS8tTpP8A0m+6abCb7cqfAVBL3ri7KQOdEfW05VaioH+rZbk2rziaFzkq+MZJsy1aMqX/bAoEt38jiK+l1d327Cf6SZbAtO5bRH5fPdajrdrSC0/3J6yX13CxdOpq6QgmLIgPxhviVpDp/JlPVizZfiprLzuQ6AF6WfMEkIsZdAFCWfKIiEsH1AwAfAMiYPDMzkLOnR4K+crGVq6pUFVVRAQAAAMATg33eSZLFeCsiAAAFOt1uF+0e9fCw+2Gu/Hl5uTWfjk/dzPnK6U8Qo+zJk5ycWp5u4tG87qxDROCQPhotvkmvlRcu7JxaNPKp7QU+oD2ZTHRpPFeZmd9m7nXmFGVWFk7nk0lSu+e+s4aK01NTzwvJZud8IVcPUuaeJBmginLxb9CV6zi7TkSt1DypPpNzOF0fxQkzLqiEiZre/XT3HSNUz7M8AN2aKgZq/qObRsBk6k6o8jQMaWFhB0ju7tuNvipHw3BbBrMqGbarHhP8p76l5TTW9MJZlbD/WqK9dCtuFaHuokJgwyUAsnT3/Ek0D62NFwpHZIzLrU5vDwMGtAJCQPSp54YDHpb80lXiY417JVHV1RuW/DJRwhvnQAHXfaaciym2GLoMqipGYAAAAAAHtbCxw7Z1ViuZEyOr3dm2tjRU0KDVcY13pPbj/17Eby7ncWa7f9NYtJFO9qHyTsUJCIuwDB/i6nZznn3SDaQ77+x38etxXl6PYX3mqt53gixfX7uybW6aWv3Wr1mML9W78gwwv//vbfbvf3aT9+VnV8+Az/dPA4chOD5/PoXMEgbr8j670su6TA9M1/6e05FKb9a/WXN2+zr7ZKHiurOmAdhnF4ymp4d53sWX+3bV81k37S/fv2X8ts9na/fvv//WAUjP/t40D897rS0g4V2euEnjaEM2AyWOhbYZBwWPx7sAT9xgvs3Pz9x73KxdZpq1X+yCh3uX8wCwywAO",numberOfSuggestions:3,openChatOnLoad:!1,position:{bottom:"20px",right:"20px"},readMark:"&#x2713;",reconnectInterval:5,reconnectMaxAttempts:50,reconnectTimeout:300,videoIcon:'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="%2341bfec" d="M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm7 7V3.5L18.5 9H13z"/></svg>',showConnectionStatus:!1,showTypingIndicator:!0,supportedFileTypes:".aac, .3g2, .3gp, .7z, .amr, .avi, .csv, .doc, .docx, .eml, .gif, .ics, .jfif, .jpeg, .jpg, .key, .log, .m4a, .m4v, .mov, .mp3, .mp4, .mp4a, .mpeg, .mpg, .mpga, .neon, .numbers, .odt, .oga, .ogg, .ogv, .pages, .pdf, .png, .pps, .ppsx, .ppt, .pptx, .qt, .svg, .tif, .tiff, .txt, .vcf, .wav, .webm, .webp, .wmv, .xls, .xlsx, .xml, .yml, .yaml",targetElement:"widgetDiv",useCustomStyle:!1,version:"1.0.0",webSocketPollingURL:"{webSocketPollingURL}",width:"30vw"}},function(t,e,n){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.AUTH="auth",t.PING="ping",t.PONG="pong"}(i||(i={})),e.STATE_TYPE=i},function(t,e,n){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.BOT="bot",t.USER="user"}(i||(i={})),e.SENDER_TYPE=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(76),o=function(){function t(t){this._mFetchToken=t}return t.getInstance=function(e){return t._service||(t._service=new t(e)),t._service},t.prototype.getToken=function(){var t=this;return new Promise(function(e,n){t._mFetchToken||n({message:"No function has been provided to fetch newly generated auth token. Please create a function that returns a Promise to generate new JWT token when called."}),t._currentAuthToken&&!t._isTokenExpired()&&e(t._currentAuthToken);var o=t._mFetchToken();null===o||"object"!=typeof o&&"function"!=typeof o||"function"!=typeof o.then?n({message:"Please provide a function that can return a Promise resolving to a token."}):o.then(function(o){t._currentAuthToken=new i.JwtToken(o),t._isValidToken()?e(t._currentAuthToken):n({message:"Token doesn't contain all mandatory claims."})},function(t){return n(t)})})},t.prototype._isTokenExpired=function(){var t=Math.floor(Date.now()/1e3)+20;return this._currentAuthToken.getClaim("exp")<t},t.prototype._isValidToken=function(){return this._currentAuthToken.getClaim("channelId")&&this._currentAuthToken.getClaim("userId")},t}();e.AuthTokenService=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this._token=t;var e=this._token.split(".");this._header=JSON.parse(atob(e[0])),this._payload=JSON.parse(atob(e[1]))}return Object.defineProperty(t.prototype,"token",{get:function(){return this._token},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"header",{get:function(){return this._header},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"payload",{get:function(){return this._payload},enumerable:!0,configurable:!0}),t.prototype.getClaim=function(t){return this.payload[t]},t}();e.JwtToken=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(8),o=n(9),s=n(2),r=n(78),a=n(15),c=function(){function t(t,e,n,i,r,a,c){this._url=t,this._authTokenService=e,this._reconnectInterval=n,this._reconnectMaxAttempts=i,this._reconnectTimeout=r,this._pollingUrl=a,this._protocols=c,this._timedOut=!1,this._forcedClose=!1,this._onlyTokenSent=!1,this._reconnectAttempt=0,this._logger=new s.Logger("ReconnectingWebSocket"),this.onclose=function(t){},this.onerror=function(t){},this.onmessage=function(t){},this.onopen=function(t){},this.onconnecting=function(){},this.onstatuschange=function(t){},this._logger.debug("WebSocket creation",this._url,"reconnectInterval: "+this._reconnectInterval,"reconnectMaxAttempts: "+this._reconnectMaxAttempts,"reconnectTimeout: "+this._reconnectTimeout),this._reconnectInterval=o.utils.secToMillisec(n),this._reconnectTimeout=o.utils.secToMillisec(r),this._setReadyState(WebSocket.CONNECTING),this._connect(!1)}return Object.defineProperty(t.prototype,"url",{get:function(){return this._url},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"protocol",{get:function(){return this._ws.protocol},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bufferedAmount",{get:function(){return this._ws.bufferedAmount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extensions",{get:function(){return this._ws.extensions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readyState",{get:function(){return this._ws?this._ws.readyState:this._readyState},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CLOSED",{get:function(){return this._ws.CLOSED},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CLOSING",{get:function(){return this._ws.CLOSING},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CONNECTING",{get:function(){return this._ws.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OPEN",{get:function(){return this._ws.OPEN},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"binaryType",{get:function(){return this._ws.binaryType},set:function(t){this._ws.binaryType=t},enumerable:!0,configurable:!0}),t.prototype.close=function(t,e){this._forcedClose=!0,this._ws&&this._ws.close(t,e)},t.prototype.send=function(t){if(this._ws)return this._logger.debug("send",this._url,t),this._onlyTokenSent=!1,this._ws.send(t);throw Error("INVALID_STATE_ERR : Pausing to reconnect WebSocket")},t.prototype.addEventListener=function(t,e,n){this._ws&&this._ws.addEventListener(t,e,n)},t.prototype.dispatchEvent=function(t){return!!this._ws&&this._ws.dispatchEvent(t)},t.prototype.removeEventListener=function(t,e,n){this._ws&&this._ws.removeEventListener(t,e,n)},t.prototype._connect=function(t){var e,n,o,s=this;this._logger.debug("Initiating connection to server",this._url),this._ws=new WebSocket(this._url,this._protocols),this._ws.onmessage=function(t){s._logger.debug("WebSocket onmessage",s._url,t.data),s.onmessage(t)},this._ws.onerror=function(t){s._logger.debug("WebSocket onerror",s._url,t),s.onerror(t)},this._ws.onopen=function(n){s._logger.debug("WebSocket opened",s._url),s._authTokenService&&(s._onlyTokenSent=!0,s._authTokenService.getToken().then(function(t){s._ws.send(JSON.stringify(a.buildAuthTokenMessage(r.TOKEN_TYPE.JWT,t.token))),setTimeout(function(){return s._onlyTokenSent=!1},2e4)})),o=s._startPingPong(),clearTimeout(e),e=null,t=!1,s._reconnectAttempt=0,s._setReadyState(WebSocket.OPEN),s.onopen(n)},this._ws.onclose=function(r){s._ws=null,clearInterval(o),s._forcedClose?(s._setReadyState(WebSocket.CLOSED),s.onclose(r)):s._authTokenService&&s._onlyTokenSent&&r.code!==i.Constants.WEBSOCKET_CLOSE_EVENT.CODE.ABNORMAL_CLOSURE?(s._logger.error("Token authentication failed, connection closed."),s._setReadyState(WebSocket.CLOSED),s.onclose(r)):(e||(e=setTimeout(function(){s._logger.debug("Reconnection attempts timed out, disconnected",s._url),clearTimeout(n),s._timedOut=!0,s._setReadyState(WebSocket.CLOSED),s.close(),s._timedOut=!1},s._reconnectTimeout)),s._setReadyState(WebSocket.CONNECTING),s.onconnecting(),t||s._timedOut||(s._logger.debug("WebSocket closed",r),s.onclose(r)),n=setTimeout(function(){s._reconnectAttempt>=s._reconnectMaxAttempts?(s._logger.debug("Reconnection attempts limit reached"),s._setReadyState(WebSocket.CLOSED),s.onclose(r),s._longPoll()):(s._reconnectAttempt++,s._logger.debug("Reconnection attempt",s._reconnectAttempt),s._connect(!0))},s._reconnectInterval))}},t.prototype._longPoll=function(){this._logger.debug("Long polling to be enabled")},t.prototype._longPollResponse=function(t){this._logger.debug("Long polling to be implemented")},t.prototype._setReadyState=function(t){this._readyState=t,this.onstatuschange(t)},t.prototype._startPingPong=function(){var t=this;return window.setInterval(function(){t._ws&&t._ws.readyState===WebSocket.OPEN&&t._ws.send(JSON.stringify(a.buildPingMessage()))},a.PING_PONG_INTERVAL)},t}();e.ReconnectingWebSocket=c},function(t,e,n){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.JWT="jwt"}(i||(i={})),e.TOKEN_TYPE=i}]).default});